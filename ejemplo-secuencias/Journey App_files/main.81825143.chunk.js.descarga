(this["webpackJsonpjourney-client"]=this["webpackJsonpjourney-client"]||[]).push([[0],{134:function(e,t,a){},209:function(e,t,a){},210:function(e,t,a){},222:function(e,t,a){e.exports=a(496)},42:function(e,t,a){},420:function(e,t,a){},437:function(e,t,a){},438:function(e,t,a){},443:function(e,t,a){},444:function(e,t,a){},445:function(e,t,a){},446:function(e,t,a){},449:function(e,t,a){},450:function(e,t,a){},451:function(e,t,a){},452:function(e,t,a){},453:function(e,t,a){},454:function(e,t,a){},455:function(e,t,a){},456:function(e,t,a){},457:function(e,t,a){},458:function(e,t,a){},459:function(e,t,a){},460:function(e,t){},462:function(e,t){},473:function(e,t,a){},474:function(e,t,a){},475:function(e,t,a){},476:function(e,t,a){},477:function(e,t,a){},478:function(e,t,a){},479:function(e,t,a){},480:function(e,t,a){},481:function(e,t,a){},482:function(e,t,a){},483:function(e,t,a){},484:function(e,t,a){},485:function(e,t,a){},486:function(e,t,a){},487:function(e,t,a){},488:function(e,t,a){},489:function(e,t,a){},490:function(e,t,a){},491:function(e,t,a){},492:function(e,t,a){},493:function(e,t,a){},494:function(e,t,a){},495:function(e,t,a){},496:function(e,t,a){"use strict";a.r(t);a(223),a(232);var n=a(0),c=a.n(n),i=a(217),r=a.n(i),s=(a(420),a(6)),l=a(1),o=a(53),u=a(3),m=a(21),d=a.n(m),v={languages:["en-US","es-LA"],activityPath:"http://147.18.97.127/activity/sales-mgr/",server:{port:3030,commentingDb:"mongodb://localhost/journey-commenting"},profileIds:{base:"base",app:"sales-mgr",favorites:"sales-mgr-favorites"},settings:{useSearch:!0,canFavorite:!1,canLike:!1,toggleCommentFieldVisibility:!1,defaultCollapseComments:!0},roles:["instructor","approver","admin","manager","customer","contentdev"],endpoint:"http://localhost:3030/",isReady:!1},f={withCredentials:!0,"Cache-Control":"no-cache, must-revalidate, post-check=0, pre-check=0, max-age=0",Expires:"Tue, 01 Jan 1980 1:00:00 GMT",Pragma:"no-cache"},p=Object(n.createContext)(v),b=function(){return Object(n.useContext)(p)},E=a(4),y={loading:!1,current:"en-US",userOverride:!1,next:"en-US",pairs:{historyLabel:"History",recommendationsLabel:"Recommendations",favoritesLabel:"Favorites"}},h=c.a.createContext(y),O=function(e,t){var a=e;switch(t.type){case"SET_LANGUAGE":a=Object(u.a)({},a,{loading:!0,userOverride:!0,next:t.data.value});break;case"SET_PAIRS":default:a=Object(u.a)({},a,{pairs:t.data.value}),a=Object(u.a)({},a,{current:t.data.languageId}),a=Object(u.a)({},a,{next:null}),a=Object(u.a)({},a,{loading:!1})}return a},g=function(e){var t=e.children,a=c.a.useReducer(O,y),i=Object(l.a)(a,2),r=i[0],s=i[1],o={state:r,dispatch:s};return Object(n.useEffect)((function(){var e=r.next;e&&d.a.get("./../translations/".concat(e,".json")).then((function(t){s({type:"SET_PAIRS",data:{value:t.data,languageId:e}})}))}),[r]),c.a.createElement(h.Provider,{value:o},t)},j=(h.Consumer,function(){var e=Object(n.useContext)(h),t=e.state,a=e.dispatch;return[function(e){return t.pairs[e]},function(){return t.current},function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.current===e||t.loading||t.userOverride&&!n||a({type:"SET_LANGUAGE",data:{value:e}})}]}),N=function(e,t){var a=b();return Object(n.useCallback)((function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],c=arguments.length>1?arguments[1]:void 0,i=a.endpoint,r={withCredentials:!0,"Cache-Control":"no-cache, must-revalidate, proxy-revalidate, post-check=0, pre-check=0, max-age=0",Expires:"Tue, 01 Jan 1980 1:00:00 GMT",Pragma:"no-cache"},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=i+t;return e.forEach((function(e,t){a+=0===t?"?".concat(e.key,"=").concat(e.value):"&".concat(e.key,"=").concat(e.value)})),a},l=function(e){var t=s(e);return d.a.get(t,r)},o=function(e,t){var a=s(e);return d.a.post(a,t,r)},m=function(e,t){return new Promise((function(a,n){var c=s(e),i=new XMLHttpRequest;i.open("POST",c),i.withCredentials=!0,i.setRequestHeader("Cache-Control","no-cache, must-revalidate, post-check=0, pre-check=0, max-age=0"),i.setRequestHeader("Expires","Tue, 01 Jan 1980 1:00:00 GMT"),i.setRequestHeader("Pragma","no-cache"),i.onload=function(){a(i.response)},i.onerror=function(){n(i.response)},i.send(t)}))},v=function(e,t){var a=s(e);return d.a.put(a,t,r)},f=function(e,t){var a=s(e);return t?d.a.delete(a,Object(u.a)({data:t},r)):d.a.delete(a,r)};switch(e){case"GET":return l(n);case"POST":return o(n,c);case"POST-FORM":return m(n,c);case"PUT":return v(n,c);case"DELETE":return f(n,c)}}),[e,t,a])},I={fetch:!0,loading:!1,groupId:null},k=Object(n.createContext)(I),S=["exercise","milestone"],C=function(e){var t=!0;return["groupId","profiles","states"].forEach((function(a){e[a]||(t=!1)})),t},T=function(e,t){var a=e;switch(t.type){case"SET_ACTIVE":a=Object(u.a)({},a,{active:t.data.value});break;case"SET_GROUP_ID":a=Object(u.a)({},a,{groupId:t.data.value}),C(a)&&(console.log("done loading"),a=Object(u.a)({},a,{loading:!1}));break;case"HYDRATE":a=Object(u.a)({},a,{profiles:t.data.profiles,states:t.data.states}),C(a)&&(console.log("done loading"),a=Object(u.a)({},a,{loading:!1}));break;case"FETCH":a=Object(u.a)({},a,{fetch:!0});break;case"FETCHING":a=Object(u.a)({},a,{fetch:!1,loading:!0});break;default:a=e}return a},w=function(e){var t=e.children,a=e.journeyId,i=e.studentId,r=e.instructorView,s=e.groupId,o=e.initActive,m=(e.active,e.preview),d=N("GET",function(e,t){return t?"activity/userActivityMap?activityId=".concat(e,"&accountId=").concat(t):"activity/userActivityMap?activityId=".concat(e)}(a,i)),v=N("GET","user/journeyGroupId"),f=Object(n.useReducer)(T,function(e,t,a,n){var c=Object(u.a)({},I);return c.journeyId=e,c.studentId=t,c.instructorView=a,c.preview=n,c}(a,i,r,m)),p=Object(l.a)(f,2),b=p[0],E=p[1];return Object(n.useEffect)((function(){b.fetch&&!b.loading&&(E({type:"FETCHING"}),d().then((function(e){var t=e.data;if(E({type:"HYDRATE",data:t}),o){var n=function(e,t){console.log("INIT ACTIVE: ".concat(e));var a=t.profiles[e].base;return"journey"===a.activityType?null:S.indexOf(a.activityType)>-1?e:function(e,t){var a=[],n=null;for(var c in t.profiles){if(t.profiles.hasOwnProperty(c))"exercise"===t.profiles[c].activityType&&a.push(c)}return a.forEach((function(a){(t.profiles[a].base.activities||[]).indexOf(e)>-1&&(n=a)})),n}(e,t)}(o,t);n&&E({type:"SET_ACTIVE",data:{value:n}})}else b.active||E({type:"SET_ACTIVE",data:{value:a}})})).catch((function(e){console.error(e)})))}),[d,o,b.fetch,b.loading]),Object(n.useEffect)((function(){(s&&b.groupId!==s&&E({type:"SET_GROUP_ID",data:{value:s}}),s||b.groupId)||v([{key:"accountId",value:i},{key:"journeyId",value:a}]).then((function(e){E({type:"SET_GROUP_ID",data:{value:e.data}})})).catch((function(e){console.error(e)}))}),[s,b.groupId]),c.a.createElement(k.Provider,{value:[b,E]},t)},A=function(){return Object(n.useContext)(k)||[{}]},P=function(){var e=A(),t=Object(l.a)(e,2)[1],a=Object(n.useState)({setActive:function(){}}),c=Object(l.a)(a,2),i=c[0],r=c[1];return Object(n.useEffect)((function(){r({setActive:function(e){t({type:"SET_ACTIVE",data:{value:e}})}})}),[t]),i},x=function(e){var t=b(),a=G().userData;return Object(n.useCallback)((function(n){var c="".concat(t.endpoint,"commenting/"),i=a.accountId,r=a.userProfiles.base.name||"[username]",s={withCredentials:!0,"Cache-Control":"no-cache, must-revalidate, post-check=0, pre-check=0, max-age=0",Expires:"Tue, 01 Jan 1980 1:00:00 GMT",Pragma:"no-cache"};switch(e){case"GET_THREAD":return function(e){var t="".concat(c,"threadWithComments/").concat(e.threadId);return d.a.get(t,s)}(n);case"GET_COMMENTS":return function(e){var t="".concat(c,"comment/").concat(e.commentId);return d.a.get(t,s)}(n);case"ADD_COMMENT_TO_THREAD":return function(e){var t="".concat(c,"addCommentToThread/").concat(e.threadId),n=(new Date).toISOString();console.log(JSON.stringify(a.userProfiles,null,4));var l={userId:i,body:e.body,timeStamp:n,name:r};return d.a.post(t,l,s)}(n);case"ADD_COMMENT_TO_COMMENT":return function(e){var t="".concat(c,"addCommentToComment/").concat(e.commentId),a=(new Date).toISOString(),n={userId:i,body:e.body,timeStamp:a,name:r};return d.a.post(t,n,s)}(n);case"FLAG_COMMENT":return function(e){var a="".concat(t.endpoint,"instructor/flagComment?commentId=").concat(e.commentId),n={userId:i};return d.a.post(a,n,s)}(n)}}),[e,t,a])},D=Object(n.createContext)({needsUpdate:[],updating:!1,initialized:!1}),U=function(e,t,a){var n=Object(E.a)(t);return e.forEach((function(e){var c=t.indexOf(e);a&&-1!==c||n.push(e)})),n},L=function(e,t){var a=Object(E.a)(t);return e.forEach((function(e){var n=t.indexOf(e);n>-1&&a.splice(n,1)})),a},R=function(e,t){var a,n,c=e;switch(t.type){case"SET_ALL_USER_DATA":(c=Object(u.a)({},t.data.value)).userProfiles=function(e,t){var a=e;return[t.base,t.app,t.favorites].forEach((function(t){e[t]||(a[t]={})})),a}(c.userProfiles,c.profileIds);break;case"UPDATE_PREFERENCES":(c=Object(u.a)({},c,{needsUpdate:U([c.profileIds.app],c.needsUpdate,!0)})).userProfiles[c.profileIds.app]=Object(u.a)({},c.userProfiles[c.profileIds.app],{preferences:t.data.value});break;case"UPDATE_COMPLETE":c=Object(u.a)({},c,{needsUpdate:L(t.data.value,c.needsUpdate),updating:!1});break;case"UPDATING":c=Object(u.a)({},c,{updating:!0});break;case"ADD_FAVORITE":(c=Object(u.a)({},c,{needsUpdate:U([c.profileIds.favorites],c.needsUpdate,!0)})).userProfiles[c.profileIds.favorites].ids=U([t.data.value],c.userProfiles[c.profileIds.favorites].ids||[],!0);break;case"REMOVE_FAVORITE":(c=Object(u.a)({},c,{needsUpdate:U([c.profileIds.favorites],c.needsUpdate,!0)})).userProfiles[c.profileIds.favorites].ids=L([t.data.value],c.userProfiles[c.profileIds.favorites].ids||[]);break;case"REMOVE_ALERT":(c=Object(u.a)({},c,{needsUpdate:U([c.profileIds.app],c.needsUpdate,!0)})).userProfiles[c.profileIds.app].alerts=(a=c.userProfiles[c.profileIds.app].alerts,n=t.data.value,Object(E.a)(a).filter((function(e){return e.id!==n})));break;default:console.warn("User Provider dispatch not handled")}return c},M=function(e){var t=e.children,a=b(),i=j(),r=Object(l.a)(i,3),s=r[1],o=r[2],u=c.a.useReducer(R,{}),m=Object(l.a)(u,2),d=m[0],v=m[1],f={state:d,dispatch:v},p=N("GET","user/profiles"),E=N("POST","user/profiles");return Object(n.useEffect)((function(){a.profileIds&&!d.initialized&&p([]).then((function(e){var t={userProfiles:e.data.userProfiles,accountId:e.data.accountId,profileIds:a.profileIds,needsUpdate:[],updating:!1,initialized:!0};v({type:"SET_ALL_USER_DATA",data:{value:t}})})).catch((function(e){console.error(e)}))}),[p,a.profileIds,d.initialized]),Object(n.useEffect)((function(){d.initialized&&d.userProfiles.base&&d.userProfiles.base.language&&s()!==d.userProfiles.base.language&&o(d.userProfiles.base.language)}),[s,o,d]),Object(n.useEffect)((function(){var e=[],t=d.needsUpdate||[];t.forEach((function(t){e.push({type:t,data:d.userProfiles[t]})})),e.length>0&&!d.updating&&(v({type:"UPDATING"}),E([],e).then((function(){v({type:"UPDATE_COMPLETE",data:{value:t}})})).catch((function(e){console.error("Failed to update profiles. Fetching current."),p([]).then((function(e){var t={userProfiles:e.data.userProfiles,accountId:e.data.accountId,profileIds:a.profileIds,needsUpdate:[],updating:!1,initialized:!0};v({type:"SET_ALL_USER_DATA",data:{value:t}})})).catch((function(e){console.error(e)}))})))}),[p,E,d,a.profileIds]),c.a.createElement(D.Provider,{value:f},t)},G=function(){var e=Object(n.useContext)(D);return{userData:e.state,userDataDispatch:e.dispatch}},F={isReady:!1,activeJourney:""},_=Object(n.createContext)([F,function(){}]),B=function(){return Object(n.useContext)(_)},J=(a(437),function(e){var t=e.userName,a=e.instructor,c=e.autoColor,i=function(){if(a)return"fff";return["C62828","388E3C","FFEB3B","1565C0","FF8F00","7B1FA2","26C6DA","F4FF81","FF8A80","00897B","B39DDB","4E342E","DD2C00","D7CCC8","DCEDC8","87b52c","FFEBEE","283593","546E7A","95c1bb","1B5E20","E65100","6D4C41","546E7A","673AB7","C2185B"][["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"].indexOf(r().toLowerCase())]},r=function(){return t?t[0]:"-"},s={backgroundColor:"#".concat(i()),color:function(){if(a)return"#000";var e=String(i());function t(e){return""===e.charAt(0)?e.substring(1,7):e}return(299*parseInt(t(e).substring(0,2),16)+587*parseInt(t(e).substring(2,4),16)+114*parseInt(t(e).substring(4,6),16))/1e3>160?"#000000":"#ffffff"}(),border:a?"2px solid #15bac0":"none"};return c?n.createElement("div",{className:"Avatar",style:s},r()):n.createElement("div",{className:"Avatar"},r())}),q=(a(438),function(e){var t=e.views,a=(e.roles,e.userName),i=j(),r=Object(l.a)(i,2),o=r[0],u=r[1];Object(n.useEffect)((function(){document.getElementById("SideMenu").classList.remove("show")}));var m=function(){document.getElementById("SideMenu").classList.remove("show")},d=function(e){var t=o("".concat(e,"Label")),a="button-label";return t&&t.length>11&&(a+=" small"),c.a.createElement("div",{className:a},t)};return c.a.createElement("div",null,c.a.createElement("div",{className:"mobile-menu-btn",role:"button",tabIndex:-1,onClick:function(){document.getElementById("SideMenu").classList.toggle("show")}}," "),c.a.createElement("div",{className:"side-menu",id:"SideMenu"},c.a.createElement("div",{className:"mobile-user-info"},c.a.createElement(J,{autoColor:!0,userName:a}),c.a.createElement("div",{className:"user-name"},a)),c.a.createElement("div",{role:"button",tabIndex:0,onClick:function(){return m()}},c.a.createElement(s.b,{activeClassName:"active",className:"button home",exact:!0,to:"/"},c.a.createElement("div",{className:"icon"}),d("home"))),t.map((function(e){var t=e;return t="home"===t?"/":"/".concat(t),c.a.createElement("div",{role:"button",tabIndex:0,onClick:function(){return m()},key:e},c.a.createElement(s.b,{activeClassName:"active",key:e,className:"button ".concat(e),to:t},c.a.createElement("div",{className:"icon"}),d(e),function(e){return"recognition"===e?c.a.createElement("div",{className:"side-menu-alert"}):null}(e)))})),c.a.createElement("div",{onClick:function(){window.open("./media/app-instructions-".concat(u(),".pdf"))},role:"button",tabIndex:0,className:"button help"},c.a.createElement("div",{className:"button-label"},"?"))))}),V=(a(443),function(e){var t=e.userName,a=e.appName,c=e.logout,i=e.avatar,r=j(),s=Object(l.a)(r,3),o=s[0],u=s[1],m=s[2],d=b(),v=[{label:"English (US)",value:"en-US"},{label:"Espa\xf1ol (LA)",value:"es-LA"}];return n.createElement("div",{id:"Header"},n.createElement("div",{className:"images"},n.createElement("div",{id:"header-image-1"})),n.createElement("div",{className:"header-app-name"},a),n.createElement("div",{className:"user-info"},t&&n.createElement("div",{className:"desktop-only"},i&&n.createElement(J,{userName:t,autoColor:!0}),n.createElement("div",{className:"user-name"},t),c&&n.createElement("div",{className:"logout",onClick:function(){window.location.href="".concat(d.endpoint,"/login")}},o("UserLogoutLabel"))),n.createElement("div",{className:"settings-menu"},n.createElement("select",{value:u(),className:"select-language",onChange:function(e){return m(e.target.value,!0)}},v.map((function(e){return n.createElement("option",{key:e.value,value:e.value},e.label)}))))))}),H=(a(444),function(e){var t=e.colorTheme,a={backgroundColor:function(){var e;switch(t){case"light":e="#eee";break;case"dark":e="#333";break;case"medium":default:e="#999"}return e}()};return n.createElement("div",{id:"Loader",className:"loader"},n.createElement("div",{className:"indicator"},n.createElement("div",{style:a}),n.createElement("div",{style:a}),n.createElement("div",{style:a}),n.createElement("div",{style:a})))}),K=(a(445),function(e){var t=e.scale,a=e.colorTheme,n=t||1,i={color:function(){var e;switch(a){case"light":e="#eee";break;case"dark":e="#333";break;case"medium":default:e="#999"}return e}()};return c.a.createElement("div",{style:{transform:"scale(".concat(n,")")}},c.a.createElement("div",{style:i,className:"comet-loader"},"Loading..."))}),z=(a(446),function(e){var t=e.route,a=(e.filters,e.realmId),i=e.onResults,r=e.onSubmit,s=Object(n.useState)(""),o=Object(l.a)(s,2),u=o[0],m=o[1],d=N("POST",t),v=function(){r&&r(),d([{key:"term",value:u},{key:"language",value:"en-US"},{key:"realmId",value:a}]).then((function(e){i(e.data.ids)})).catch((function(e){i([])}))};return c.a.createElement("div",{id:"SearchBar",className:"search-bar"},c.a.createElement("button",{onClick:function(){return v()},type:"button",className:"search-submit"}," "),c.a.createElement("input",{onChange:function(e){m(e.target.value)},onKeyDown:function(e){13===e.which&&v()}}))}),Q=a(220),$=a.n(Q),W=(a(449),function(e){var t=e.children,a=e.onChange,i=e.instructions,r=e.dropAreaLabel,s=e.accept,o=e.className,u=j(),m=Object(l.a)(u,1)[0],d=Object(n.useState)(!1),v=Object(l.a)(d,2),f=v[0],p=v[1],b=Object(n.useRef)(null),E=Object(n.useRef)(null),y=function(e){E.current&&E.current.files&&E.current.files.length>0&&a(E.current.files[0])};Object(n.useEffect)((function(){var e=b.current,t=function(e){e.preventDefault(),e.stopPropagation()},n=function(e){t(e),p(!0)},c=function(a){t(a),a.target===e&&p(!1)},i=function(e){var t,n;c(e),1===(null===(t=e.dataTransfer)||void 0===t||null===(n=t.files)||void 0===n?void 0:n.length)&&a(e.dataTransfer.files[0])};return e&&(e.addEventListener("dragenter",n,!1),e.addEventListener("dragover",t,!1),e.addEventListener("dragleave",c,!1),e.addEventListener("drop",i,!1)),function(){e&&(e.removeEventListener("dragenter",n,!1),e.removeEventListener("dragleave",c,!1),e.removeEventListener("dragover",t,!1),e.removeEventListener("drop",i,!1))}}));return c.a.createElement("div",{className:"FileSelect"},c.a.createElement("div",{ref:b,className:"droparea ".concat(f?"highlight":"")},c.a.createElement("div",{className:"dropnotice"},r||m("UserUploadDropAreaLabel")),c.a.createElement("div",{className:"user-upload-content"},c.a.createElement("div",{className:"drop-file-instructions"},i||m("UserUploadInstructions")),c.a.createElement("label",{form:"file-input",className:"file"},s?c.a.createElement("input",{type:"file",className:"".concat(o||"file-select"),ref:E,id:"file",name:"file",accept:s,onChange:y}):c.a.createElement("input",{type:"file",ref:E,id:"csv-file",name:"csv-file",onChange:y}),c.a.createElement("span",{className:"file-custom",title:function(){var e,t,a,n;return(null===(e=E.current)||void 0===e?void 0:e.files)&&(null===(t=E.current)||void 0===t?void 0:t.files[0])&&(null===(a=E.current)||void 0===a?void 0:a.files[0].name)?null===(n=E.current)||void 0===n?void 0:n.files[0].name:"Upload file here"}()},function(){var e,t,a,n,c;return(null===(e=E.current)||void 0===e?void 0:e.files)&&(null===(t=E.current)||void 0===t?void 0:t.files[0])?(null===(a=E.current)||void 0===a?void 0:a.files[0].name.length)>20?"".concat(null===(c=E.current)||void 0===c?void 0:c.files[0].name.slice(0,15),"..."):null===(n=E.current)||void 0===n?void 0:n.files[0].name:"Choose File..."}(),c.a.createElement("span",{className:"file-custom-button"},"Browse"))),t)))}),Y=(a(450),a(451),function(e){var t=e.id,a=e.initialText,i=e.onChange,r=j(),s=Object(l.a)(r,1)[0],o=Object(n.useState)(a),u=Object(l.a)(o,2),m=u[0],d=u[1],v=Object(n.useState)(!1),f=Object(l.a)(v,2),p=f[0],E=f[1],y=Object(n.useState)(null),h=Object(l.a)(y,2),O=h[0],g=h[1],I=Object(n.useState)(null),k=Object(l.a)(I,2),S=k[0],C=k[1],T=Object(n.useState)(!1),w=Object(l.a)(T,2),A=w[0],P=w[1],x=Object(n.useState)(!1),D=Object(l.a)(x,2),U=D[0],L=D[1],R=Object(n.useState)(""),M=Object(l.a)(R,2),G=M[0],F=M[1],_=Object(n.useState)(!1),B=Object(l.a)(_,2),J=B[0],q=B[1],V=Object(n.useRef)(null),K=N("POST-FORM","admin/fileUpload"),z=b();Object(n.useEffect)((function(){if(V.current&&!p){E(!1);var e=new $.a(V.current,{theme:"snow",modules:{toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}],["image","video"]]}});e.root.innerHTML=m,e.on("editor-change",(function(t,a){"text-change"===t&&d(e.root.innerHTML)})),e.getModule("toolbar").addHandler("image",(function(){C(e.getSelection()),P(!0)})),e.getModule("toolbar").addHandler("video",(function(){C(e.getSelection()),L(!0)})),E(!0),g(e)}}),[p,O,m]),Object(n.useEffect)((function(){a!==m&&i(t,m)}),[t,a,i,m]);var Q=function(e){q(!0);var t=new FormData;t.append("file",e),K([],t).then((function(e){!function(e){O.insertEmbed(S.index,"image",e)}("".concat(z.endpoint).concat(e)),P(!1),q(!1)})).catch((function(e){console.error(e)}))};return c.a.createElement("div",{className:"rich-text-area"},c.a.createElement("div",{className:"editor",ref:V}),A&&!J&&c.a.createElement("div",{className:"image-select-wrapper select-wrapper"},c.a.createElement("div",{className:"image-select-box select-box"},c.a.createElement(W,{onChange:function(e){return Q(e)},accept:"image/*"}))),U&&!J&&c.a.createElement("div",{className:"video-select-wrapper select-wrapper"},c.a.createElement("div",{className:"video-select-box select-box"},c.a.createElement("div",{className:"video-select-label select-label"},"Embed URL:"),c.a.createElement("input",{type:"text",name:"video-select",onChange:function(e){return F(e.target.value)},value:G,autoComplete:"off"}),c.a.createElement("button",{type:"button",className:"add-button",onClick:function(){!function(){var e='<a href="'.concat(G,'">').concat(G,"</a>");O.clipboard.dangerouslyPasteHTML(S.index,e),L(!1)}()}},s("AdminActivityAddContent")))),J&&c.a.createElement("div",{className:"loading-wrapper"},c.a.createElement(H,{colorTheme:"light"})))}),X=(a(452),function(e){var t=e.noteData,a=e.clickCallback,n=j(),i=Object(l.a)(n,1)[0],r=G(),o=r.userData,u=r.userDataDispatch,m=b(),d=function(e){var t=o.userProfiles[m.profileIds.base].language;return"string"===typeof e?e:e[t]?e[t]:void 0===e[t]?e[Object.keys(e)[0]]:i("AnnouncementMessageMissing")};return c.a.createElement("div",{"data-testid":"Notifications",className:"notifications-list"},t.map((function(e){var t=e.id,n=e.url,i=e.date,r=e.content;return n?c.a.createElement(s.b,{key:t,to:n,onClick:function(){return function(e){a&&a(e),u({type:"REMOVE_ALERT",data:{value:e}})}(t)}},c.a.createElement("div",{className:"notifications"},c.a.createElement("div",{className:"notification-block",tabIndex:0,role:"button"},c.a.createElement("div",{className:"icon"}),c.a.createElement("div",null,c.a.createElement("div",{className:"message"},d(r)),c.a.createElement("div",{className:"timestamp"},i))))):c.a.createElement("div",{key:t,className:"notifications nolink"},c.a.createElement("div",{className:"notification-block",tabIndex:0,role:"button"},c.a.createElement("div",{className:"icon"}),c.a.createElement("div",null,c.a.createElement("div",{className:"message"},d(r)),c.a.createElement("div",{className:"timestamp"},i))))})),t.length<1&&c.a.createElement("div",{className:"no-notes"},i("NoNotificationsMessage")))}),Z=function(e){var t=e.noteData,a=N("GET","instructor/userProfiles"),i=Object(n.useState)(null),r=Object(l.a)(i,2),o=r[0],u=r[1];return Object(n.useEffect)((function(){var e=[{key:"accountId",value:t.accountId}];a(e).then((function(e){u(e.data.userProfiles)})).catch((function(e){console.error(e)}))}),[t]),null===o?c.a.createElement("div",null,"Loading..."):c.a.createElement("div",{className:"AssignmentNotice"},c.a.createElement(s.b,{to:"activityInJourney?activityId=".concat(t.activityId,"&studentId=").concat(t.accountId,"&instructorView=1")},c.a.createElement("div",{className:"notifications"},c.a.createElement("div",{className:"notification-block"},c.a.createElement("div",{className:"icon assignment"}),c.a.createElement("div",{className:"message"},"New Assignment from ".concat(o.base.name))))))},ee=function(){var e=G().userData,t=Object(n.useState)([]),a=Object(l.a)(t,2),c=a[0],i=a[1],r=N("GET","activity/getActivity"),s=b();return Object(n.useEffect)((function(){var t=[],a=[],n=0;e.userProfiles[s.profileIds.app].groups.forEach((function(c){var l=[{key:"activityId",value:"http://147.18.97.127/activity/".concat(s.profileIds.app,"/app")},{key:"profileId",value:c}];r(l).then((function(r){var l=r.data[c].activities||[];return l=l.filter((function(e,t){return-1===a.indexOf(e)})),a=a.concat(l),l.forEach((function(e){t.push({journeyId:e,groupId:c})})),(n+=1)>=e.userProfiles[s.profileIds.app].groups.length&&i(t),!0})).catch((function(e){console.error(e)}))}))}),[s.profileIds.app,r,e.userProfiles]),c||[]},te=(a(453),function(e){var t=e.journeyId,a=e.includeCohort,i=b(),r=A(),s=Object(l.a)(r,1)[0],o=(G().userData,j()),u=Object(l.a)(o,2),m=u[0],d=u[1],v=Object(n.useState)(null),f=Object(l.a)(v,2),p=f[0],E=f[1],y=Object(n.useState)(null),h=Object(l.a)(y,2),O=h[0],g=h[1],I=N("GET","activity/getActivity");Object(n.useEffect)((function(){if(s&&!s.loading&&!s.fetch){var e=[{key:"activityId",value:t},{key:"profileId",value:s.groupId}],a=[{key:"activityId",value:"".concat(i.activityPath,"app")},{key:"profileId",value:s.groupId}];I(e).then((function(e){g(e.data[s.groupId]||{})})).catch((function(e){console.error(e)})),I(a).then((function(e){E(e.data[s.groupId]||{})})).catch((function(e){console.error(e)}))}}),[s]);if(!s||s.loading||s.fetch||!O||!p)return c.a.createElement(H,{colorTheme:"light"});var k=O&&O.progress&&O.progress[s.studentId]||0,S=function(){if(!s)return 1;var e=0;return(s.profiles[t].base.activities||[]).forEach((function(t){var a=s.profiles[t].base.activities||[];e+=a.length})),0===e?1:e}(),C=Math.round(k/S*100),T=function(){var e=0,t=0;if(!O.progress)return[0,0];var a=p.users||[];return a.forEach((function(a){var n=O.progress[a]||0;n>e&&(e=n),t+=n})),t/=a.length,[e,t]}(),w=Object(l.a)(T,2),P=w[0],x=w[1],D=Math.round(P/S*100),U=Math.round(x/S*100);return c.a.createElement("div",{role:"button",tabIndex:0,id:"journey-status-".concat(t),className:"journey-status"},c.a.createElement("div",{className:"journey-title"},function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return e&&e[t]&&e[t][d()]||a}(s.profiles[t].base,"title",t)),c.a.createElement("div",{className:"status-bar"},c.a.createElement("div",{className:"progress-container user"},c.a.createElement("div",{className:"progress-fill user",style:{width:"".concat(C,"%")}},"".concat(C,"%"))),c.a.createElement("div",{className:"progress-label"},"".concat(k,"/").concat(S))),a&&c.a.createElement("div",null,c.a.createElement("div",{className:"journey-progress-best"},c.a.createElement("div",{className:"progress-header"},m("cohortBest")),c.a.createElement("div",{className:"status-bar"},c.a.createElement("div",{className:"progress-container best"},c.a.createElement("div",{className:"progress-fill best",style:{width:"".concat(D,"%")}},"".concat(D,"%"))))),c.a.createElement("div",{className:"journey-progress-avg"},c.a.createElement("div",{className:"progress-header"},m("cohortAverage")),c.a.createElement("div",{className:"status-bar"},c.a.createElement("div",{className:"progress-container avg"},c.a.createElement("div",{className:"progress-fill avg",style:{width:"".concat(U,"%")}},"".concat(U,"%")))))))}),ae=(a(209),function(){var e=b(),t=G(),a=t.userData,n=t.userDataDispatch,i=ee(),r=B(),o=Object(l.a)(r,2)[1],m=function(t){var n;return(null===(n=a.userProfiles[e.profileIds.app].preferences)||void 0===n?void 0:n.defaultJourney)===t?"favorite-star selected":"favorite-star"},d=function(e){var t;a.userProfiles[a.profileIds.app].preferences=a.userProfiles[a.profileIds.app].preferences||{},(t=Object(u.a)({},a.userProfiles[a.profileIds.app].preferences)).defaultJourney=e,n({type:"UPDATE_PREFERENCES",data:{value:t}})};return c.a.createElement("div",{"data-testid":"GroupJourneys",className:"GroupJourneys"},i.length>0&&i.map((function(e){return c.a.createElement(w,{key:e.journeyId,journeyId:e.journeyId,groupId:e.groupId,studentId:a.accountId,instructorView:!1},c.a.createElement("div",{"data-testid":"journey-status",className:"journey-status-container"},c.a.createElement(s.b,{onClick:function(){return o({activeJourney:e.journeyId})},to:"/journey"},c.a.createElement(te,{journeyId:e.journeyId,includeCohort:!0})),c.a.createElement("div",{onClick:function(){return d(e.journeyId)},className:m(e.journeyId),role:"button",tabIndex:0,onKeyDown:function(t){13===t.which&&d(e.journeyId)},title:"Set favorite"}," ")))})))}),ne=function(){var e=j(),t=Object(l.a)(e,1)[0],a=b(),n=G().userData;return c.a.createElement("div",{"data-testid":"HomeView",className:"home-view"},c.a.createElement("div",{className:"home-view-title"},c.a.createElement("h1",null,t("HomeViewTitle"))),c.a.createElement("div",{className:"home-view-sections"},c.a.createElement("section",{"data-testid":"myjourneys",className:"my-journeys"},c.a.createElement("div",{className:"home-section-title"},c.a.createElement("h2",null,t("myActiveJourneysLabel")),c.a.createElement("div",{className:"options"})),c.a.createElement(ae,null)),c.a.createElement("section",{className:"my-social"},c.a.createElement("div",{className:"home-section-title"},c.a.createElement("h2",null,t("myNotificationsLabel")),c.a.createElement("div",{className:"options"})),c.a.createElement(X,{noteData:n.userProfiles[a.profileIds.app].alerts}))))},ce=(a(454),a(97),{isReady:!1,activityId:"",activityMap:{},editActivityId:"",needsUpdate:!0}),ie=Object(n.createContext)([ce,function(){},function(){},function(){}]),re=function(e){var t=e.children,a=Object(n.useState)(ce),i=Object(l.a)(a,2),r=i[0],s=i[1],o=N("GET","admin/activityMap"),m=N("POST","admin/activity"),d=b();Object(n.useEffect)((function(){s((function(e){return console.info("set init"),Object(u.a)({},e,{isReady:!0})}))}),[]);var v=Object(n.useCallback)((function(e,t){var a=[{key:"activityId",value:d.activityPath+e}];return m(a,[{type:"base",data:t}]).catch((function(){console.info("If you see a POST error on this update it is likely due to the search methods")}))}),[d.activityPath,m]),f=Object(n.useCallback)((function(e,t,a){return v(e,t).then((function(){if(t.activities!==r.activityMap[d.activityPath+e].base.activities)return E({needsUpdate:!0,activityId:r.activityId});a||s((function(a){var n=Object(u.a)({},a.activityMap);return n[d.activityPath+e].base=Object(u.a)({},n[d.activityPath+e].base,{},t),Object(u.a)({},a,{activityMap:n})}))})).catch((function(){}))}),[v,r.activityMap]),p=Object(n.useCallback)((function(e){if(Object.keys(r.activityMap).map((function(t){var a=Object(u.a)({},r.activityMap[t].base);-1!==a.activities.indexOf(d.activityPath+e)&&(a.activities.splice(a.activities.indexOf(d.activityPath+e),1),v(r.activityMap[t].base.id,a))})),e){var t=Object(u.a)({},r.activityMap[d.activityPath+e].base);t.status="REMOVED",v(e,t)}E({editActivityId:""})}),[r.activityMap]),E=Object(n.useCallback)((function(e){var t=Object(u.a)({needsUpdate:!0},e),a=e.activityId;a&&a.length>0?o([{key:"activityId",value:a}]).then((function(e){s((function(a){return Object(u.a)({},a,{},t,{activityMap:e.data,needsUpdate:!1})}))})).catch((function(e){console.error(e)})):s((function(e){return Object(u.a)({},e,{},t)}))}),[r.activityId,r.activityMap,f]);return c.a.createElement(ie.Provider,{value:[r,E,f,p]},t)},se=function(){return Object(n.useContext)(ie)},le=(a(455),function(){var e=j(),t=Object(l.a)(e,1)[0],a=G().userData,i=b(),r=Object(n.useState)(!1),o=Object(l.a)(r,2),u=o[0],m=o[1],d=Object(n.useState)(!1),v=Object(l.a)(d,2),f=v[0],p=v[1],E=Object(n.useState)(!1),y=Object(l.a)(E,2),h=y[0],O=y[1];return Object(n.useEffect)((function(){a.userProfiles[i.profileIds.app].roles.includes("admin")&&(m(!0),p(!0),O(!0)),a.userProfiles[i.profileIds.app].roles.includes("customer")&&O(!0),a.userProfiles[i.profileIds.app].roles.includes("contentdev")&&m(!0)}),[i.profileIds.app,a]),c.a.createElement("div",{className:"AdminPanels admin-panels"},u&&c.a.createElement("div",{className:"base-panel activity-panel"},c.a.createElement("h2",null,t("AdminActivitiesTitle")),c.a.createElement("div",{className:"panel-menu"},c.a.createElement(s.b,{className:"panel-selection add-activity",to:"/admin/addActivity"},c.a.createElement("div",{className:"icon"}),c.a.createElement("div",{className:"label"},t("AdminAddActivity"))),c.a.createElement(s.b,{className:"panel-selection edit-activity",to:"/admin/editActivity"},c.a.createElement("div",{className:"icon"}),c.a.createElement("div",{className:"label"},t("AdminEditActivity"))),c.a.createElement(s.b,{className:"panel-selection add-announcement",to:"/admin/addAnnouncement"},c.a.createElement("div",{className:"icon"}),c.a.createElement("div",{className:"label"},t("AdminAnnouncement"))),c.a.createElement(s.b,{className:"panel-selection import-export",to:"/admin/importexport"},c.a.createElement("div",{className:"icon"}),c.a.createElement("div",{className:"label"},"Import / Export")))),f&&c.a.createElement("div",{className:"base-panel user-panel"},c.a.createElement("h2",null,t("AdminUsersTitle")),c.a.createElement("div",{className:"panel-menu"},c.a.createElement(s.b,{className:"panel-selection add-user",to:"/admin/addUsers"},c.a.createElement("div",{className:"icon"}),c.a.createElement("div",{className:"label"},t("AdminAddUsers"))),c.a.createElement(s.b,{className:"panel-selection edit-user",to:"/admin/editUser"},c.a.createElement("div",{className:"icon"}),c.a.createElement("div",{className:"label"},t("AdminEditUsers"))),c.a.createElement(s.b,{className:"panel-selection add-group",to:"/admin/addGroup"},c.a.createElement("div",{className:"icon"}),c.a.createElement("div",{className:"label"},t("AdminAddGroup"))),c.a.createElement(s.b,{className:"panel-selection edit-group",to:"/admin/editGroup"},c.a.createElement("div",{className:"icon"}),c.a.createElement("div",{className:"label"},t("AdminEditGroup"))))),h&&c.a.createElement("div",{className:"base-panel reports-panel"},c.a.createElement("h2",null,t("AdminReportsTitle")),c.a.createElement("div",{className:"panel-menu"},c.a.createElement(s.b,{className:"panel-selection reports",to:"/admin/activityReports"},c.a.createElement("div",{className:"icon"}),c.a.createElement("div",{className:"label"},t("AdminActivityReports"))),c.a.createElement(s.b,{className:"panel-selection reports",to:"/admin/userReports"},c.a.createElement("div",{className:"icon"}),c.a.createElement("div",{className:"label"},t("AdminUserReports"))))))}),oe=function(){var e=Object(n.useState)(""),t=Object(l.a)(e,2),a=t[0],i=t[1],r=j(),s=Object(l.a)(r,1)[0],o=b(),u=Object(n.useState)(!1),m=Object(l.a)(u,2),d=m[0],v=(m[1],Object(n.useState)(!1)),f=Object(l.a)(v,2),p=f[0],E=f[1],y=Object(n.useState)(!1),h=Object(l.a)(y,2),O=h[0],g=h[1],N=Object(n.useState)(null),I=Object(l.a)(N,2),k=I[0],S=I[1];return c.a.createElement("div",{id:"Export"},d&&c.a.createElement("div",{className:"message-wrapper submitting"},c.a.createElement("div",{className:"message"},s("ExportMessage"))),p&&c.a.createElement("div",{onClick:function(){return E(!1)},role:"button",tabIndex:0,onKeyDown:function(e){13===e.which&&E(!1)},className:"message-wrapper submitting"},c.a.createElement("div",{className:"message"},c.a.createElement("span",{className:"success"},"\u2714 "),s("ExportSuccess"))),O&&c.a.createElement("div",{onClick:function(){return g(!1)},role:"button",tabIndex:0,onKeyDown:function(e){13===e.which&&g(!1)},className:"message-wrapper submitting"},c.a.createElement("div",{className:"message"},c.a.createElement("span",{className:"fail"},"\u2718 "),s("ExportFail"))),c.a.createElement("div",{className:"field-item admin-form-body admin-input"},c.a.createElement("h3",null,s("ExportTitle")),c.a.createElement("p",null,s("ExportDesc")),c.a.createElement("input",{onChange:function(e){return function(e){i(e)}(e.target.value)},value:a,id:"activityId"}),c.a.createElement("button",{onClick:function(){S("".concat("http://50.229.61.229:2120/","admin/exportActivity?activityId=").concat(o.activityPath).concat(a))},type:"button",className:"admin-form-submit-button"},s("ExportButton"))),k&&c.a.createElement("div",{style:{display:"none"}},c.a.createElement("iframe",{title:"report",src:k})))},ue=function(){var e=Object(n.useState)(""),t=Object(l.a)(e,2),a=t[0],i=t[1],r=j(),s=Object(l.a)(r,1)[0],o=N("POST","admin/importActivity"),u=Object(n.useState)(),m=Object(l.a)(u,2),d=m[0],v=m[1],f=Object(n.useState)(!1),p=Object(l.a)(f,2),b=p[0],E=p[1],y=Object(n.useState)(!1),h=Object(l.a)(y,2),O=h[0],g=h[1],I=Object(n.useState)(!1),k=Object(l.a)(I,2),S=k[0],C=k[1],T=Object(n.useCallback)((function(e){E(!0);var t=new FormData;t.append("zipData",e),o([],t).then((function(e){E(!1),g(!0),i("")})).catch((function(e){console.error(e),E(!1),C(!0)}))}),[o,a]);return c.a.createElement("div",{id:"Import"},b&&c.a.createElement("div",{className:"message-wrapper submitting"},c.a.createElement("div",{className:"message"},s("ImportMessage"))),O&&c.a.createElement("div",{onClick:function(){return g(!1)},role:"button",tabIndex:0,onKeyDown:function(e){13===e.which&&g(!1)},className:"message-wrapper submitting"},c.a.createElement("div",{className:"message"},c.a.createElement("span",{className:"success"},"\u2714 "),s("ImportSuccess"))),S&&c.a.createElement("div",{onClick:function(){return C(!1)},role:"button",tabIndex:0,onKeyDown:function(e){13===e.which&&C(!1)},className:"message-wrapper submitting"},c.a.createElement("div",{className:"message"},c.a.createElement("span",{className:"fail"},"\u2718 "),s("ImportFail"))),c.a.createElement("div",{className:"field-item admin-form-body admin-input"},c.a.createElement("h3",null,"Import"),c.a.createElement(W,{onChange:v,className:"user-upload-section-file-select",accept:".zip"}),c.a.createElement("button",{onClick:function(){d&&T(d)},type:"button",className:"admin-form-submit-button"},"Import")))},me=(a(456),function(){var e=Object(n.useState)("import"),t=Object(l.a)(e,2),a=t[0],i=t[1],r=j(),s=Object(l.a)(r,1)[0];return c.a.createElement("div",{id:"ImportExport",className:"editor"},c.a.createElement("div",{className:"step-list"},c.a.createElement("button",{className:"step-link".concat("import"===a?" active":""),onClick:function(){return i("import")},type:"button",tabIndex:0},s("ImportTab")),c.a.createElement("button",{className:"step-link".concat("export"===a?" active":""),onClick:function(){return i("export")},type:"button",tabIndex:0},s("ExportTab"))),"export"===a&&c.a.createElement(oe,null),"import"===a&&c.a.createElement(ue,null))}),de=a(221),ve=function(e){var t=e.onSelect,a=e.mode,i=e.parentActivity,r=N("GET","admin/activityTemplate"),s=N("GET","admin/activities"),o=Object(n.useState)(null),u=Object(l.a)(o,2),m=u[0],d=u[1],v=j(),f=Object(l.a)(v,1)[0],p=Object(n.useState)(),b=Object(l.a)(p,2),E=b[0],y=b[1],h=Object(n.useState)(!0),O=Object(l.a)(h,2),g=O[0],I=O[1];Object(n.useEffect)((function(){if("child"!==a&&I(!1),i&&("journey"===i.activityType&&(k("milestone"),I(!1)),"milestone"===i.activityType&&(k("exercise"),I(!1)),"exercise"===i.activityType))if(0===i.activities.length)I(!1);else{var e=[{key:"activityIds",value:JSON.stringify(i.activities)}];s(e).then((function(e){y(e.data)})).then((function(){I(!1)})).catch((function(e){console.error(e)}))}}),[]);var k=function(e){d(e),r([{key:"templateId",value:e}]).then((function(a){t(a.data,e)})).catch((function(e){console.error(e)}))},S=function(e){var t="template-selection basic-button";return e===m&&(t+=" active"),E&&(null===i||void 0===i||i.activities.forEach((function(a){"resource"!==e&&E[a]&&("poll"!==E[a].base.activityType&&"assessment"!==E[a].base.activityType||(t+=" locked"))}))),t};return g?c.a.createElement(H,{colorTheme:"dark"}):c.a.createElement("div",{className:"step"},c.a.createElement("h4",null,function(){if(a){if("journey"===(null===i||void 0===i?void 0:i.activityType))return f("AdminCreateMilestone");if("milestone"===(null===i||void 0===i?void 0:i.activityType))return f("AdminCreateExercise")}return null}()),"child"!==a&&c.a.createElement("div",null,c.a.createElement("h3",null,f("AdminActivityTemplateMessage")),c.a.createElement("h4",null,f("TemplateTypeBaseTitle")),c.a.createElement("div",{className:"template-menu"},c.a.createElement("button",{type:"button",className:S("journey"),onClick:function(){return k("journey")}},f("TemplateJourney")),c.a.createElement("button",{type:"button",className:S("milestone"),onClick:function(){return k("milestone")}},f("TemplateMilestone")),c.a.createElement("button",{type:"button",className:S("exercise"),onClick:function(){return k("exercise")}},f("TemplateExercise")))),a&&("exercise"===(null===i||void 0===i?void 0:i.activityType)?c.a.createElement("div",null,c.a.createElement("div",null,c.a.createElement("h4",null,"Add resources to selected exercise"),c.a.createElement("button",{type:"button",className:S("resource"),onClick:function(){return k("resource")}},f("TemplateResource"))),c.a.createElement("div",null,function(){var e=!0;return E&&(null===i||void 0===i||i.activities.forEach((function(t){E[t]&&("poll"!==E[t].base.activityType&&"assessment"!==E[t].base.activityType||(e=!1))}))),e?c.a.createElement("h4",null,f("AdminActivityPollMessage")):c.a.createElement("h4",null,f("AdminActivityNoPollMessage"))}(),c.a.createElement("div",{className:"template-menu"},c.a.createElement("button",{type:"button",className:S("assessment"),onClick:function(){return k("assessment")}},f("TemplateAssessment")),c.a.createElement("button",{type:"button",className:S("poll"),onClick:function(){return k("poll")}},f("TemplatePoll"))))):null))},fe=(a(210),function(e){var t=e.editLanguage,a=e.languages,i=e.listData,r=e.questionIndex,s=e.onChange,o=e.questionId,u=Object(n.useState)(0),m=Object(l.a)(u,2),d=m[0],v=m[1],f=j(),p=Object(l.a)(f,1)[0],b=function(e,a){var n=Object(E.a)(i);n[e].text[t]=a,s(r,n)},y=function(e){var t=Object(E.a)(i);t[e].correct=!t[e].correct,s(r,t)},h=function(e,a){var n=a+1;return c.a.createElement("div",{key:"".concat(o,"-answer-").concat(a),className:"admin-answer"},c.a.createElement("p",null,"".concat(p("AnswerLabel")," ").concat(n)),c.a.createElement("button",{className:"remove-assessment-selection",onClick:function(){!function(e){var t=Object(E.a)(i);t.splice(e,1),s(r,t),v(d+1)}(a)},type:"button"},"\xd7"),c.a.createElement("div",{className:"admin-correct"},c.a.createElement("input",{type:"checkbox",id:"".concat(o,"-answer-").concat(a),name:"correct",value:"answer-".concat(a),checked:e.correct,className:"form-checkbox",onChange:function(){y(a)}}),c.a.createElement("label",{htmlFor:"".concat(o,"-answer-").concat(a)},p("AdminAssessmentCorrect"))),c.a.createElement(Y,{key:"answer-".concat(a).concat(t),id:"answer-".concat(a,"text"),initialText:e.text[t],onChange:function(e,t){return b(a,t)}}))};return c.a.createElement("div",{key:"version-".concat(d),className:"answer-list"},i.map((function(e,t){return h(e,t)})),c.a.createElement("button",{type:"button",className:"add-answer-button",onClick:function(){return function(){var e=Object(E.a)(i),t=a.reduce((function(e,t){return e[t.value]="",e}),{}),n="answer-".concat(i.length);e.push({id:n,text:t,correct:!1}),s(r,e)}()}},p("AdminAssessmentAddAnswer")))}),pe=function(e){var t=e.editLanguage,a=e.languages,i=e.listData,r=e.onChange,s=Object(n.useState)(0),o=Object(l.a)(s,2),u=o[0],m=o[1],d=j(),v=Object(l.a)(d,1)[0],f=function(e,a){var n=Object(E.a)(i);n[e].text[t]=a,r(n)},p=function(e,t){var a=Object(E.a)(i),n=a[e],c=[];n.answers=t,n.answers.forEach((function(e){e.correct&&c.push(e.id)})),n.correct=c,n.correct.length>1&&(n.multiAnswer=!0),r(a)},b=function(e,n){var s=n+1;return c.a.createElement("div",{key:"question-".concat(n),className:"question",id:e.id},c.a.createElement("p",null,"".concat(v("QuestionLabel")," ").concat(s)),c.a.createElement("button",{className:"remove-assessment-selection",onClick:function(){!function(e){var t=Object(E.a)(i);t.splice(e,1),r(t),m(u+1)}(n)},type:"button"},"\xd7"),c.a.createElement(Y,{key:"question-".concat(n).concat(t),id:"question-".concat(n,"text"),initialText:e.text[t],onChange:function(e,t){return f(n,t)}}),c.a.createElement(fe,{editLanguage:t,languages:a,listData:e.answers,questionIndex:n,onChange:p,questionId:e.id}))};return c.a.createElement("div",{key:"version-".concat(u),className:"question-list"},i.map((function(e,t){return b(e,t)})),c.a.createElement("button",{type:"button",className:"add-question-button",onClick:function(){return function(){var e=Object(E.a)(i),t=a.reduce((function(e,t){return e[t.value]="",e}),{}),n="question-".concat(i.length);e.push({id:n,text:t,multiAnswer:!1,answers:[],correct:[]}),r(e)}()}},v("AdminAssessmentAddQuestion")))},be=(a(457),function(e){var t=e.editLanguage,a=e.languages,i=e.listData,r=e.onChange,s=Object(n.useState)(0),o=Object(l.a)(s,2),u=o[0],m=o[1],d=j(),v=Object(l.a)(d,1)[0],f=Object(n.useState)(0),p=Object(l.a)(f,2),b=p[0],y=p[1];Object(n.useEffect)((function(){y(i.length)}),[]);var h=function(e,a){var n=Object(E.a)(i);n[e].text[t]=a,r(n)},O=function(e,a){var n=a+1;return c.a.createElement("div",{key:"option-".concat(a),className:"poll-option"},c.a.createElement("p",null,"".concat(v("OptionLabel")," ").concat(n)),c.a.createElement("button",{className:"remove-selection",onClick:function(){!function(e){var t=Object(E.a)(i);t.splice(e,1),r(t),m(u+1)}(a)},type:"button"},"\xd7"),c.a.createElement(Y,{key:"question-".concat(a).concat(t),id:"question-".concat(a,"text"),initialText:e.text[t],onChange:function(e,t){return h(a,t)}}))};return c.a.createElement("div",{key:"version-".concat(u),className:"option-list"},i.map((function(e,t){return O(e,t)})),c.a.createElement("button",{type:"button",className:"add-option-button",onClick:function(){return function(){var e=Object(E.a)(i),t=a.reduce((function(e,t){return e[t.value]="",e}),{});e.push({id:"option-".concat(b),text:t}),y(b+1),r(e)}()}},v("AdminPollAddOption")))}),Ee=(a(458),function(e){e.onChange;var t=Object(n.useState)([]),a=Object(l.a)(t,2),i=a[0],r=a[1],s=j(),o=Object(l.a)(s,1)[0],u=b(),m=Object(n.useState)(null),d=Object(l.a)(m,2),v=d[0],f=d[1];return Object(n.useEffect)((function(){u.realmSelect&&f(u.realmSelect)}),[u.realmSelect]),v?c.a.createElement("div",{className:"admin-input"},c.a.createElement("div",{className:"realm-select"},c.a.createElement("div",{className:"label"},o("AdminRealms")),v.map((function(e){return c.a.createElement("div",{key:e,className:"realm-select-option"},c.a.createElement("input",{type:"checkbox",id:e,name:e,value:e,checked:i.indexOf(e)>-1,onChange:function(e){return function(e){var t=e.target.checked,a=e.target.name,n=Object(E.a)(i),c=n.indexOf(a);t?c<0&&n.push(a):c>-1&&n.splice(c,1),r(n)}(e)},className:"form-checkbox"}),c.a.createElement("label",{htmlFor:e},o("".concat(e,"RealmLabel"))))})))):null}),ye=function(e){var t=e.activityData,a=e.completionIds,i=e.onChange,r=N("GET","admin/activities"),s=Object(n.useState)(null),o=Object(l.a)(s,2),u=o[0],m=o[1],d=Object(n.useState)(!0),v=Object(l.a)(d,2),f=v[0],p=v[1],b=j(),y=Object(l.a)(b,2)[1];Object(n.useEffect)((function(){p(!0);var e=t.activities||[];if(e.length>0){var a=[{key:"activityIds",value:JSON.stringify(e)}];r(a).then((function(e){m(e.data)})).then((function(){p(!1)})).catch((function(e){console.error(e)}))}else p(!1)}),[t,a,r]);if(!t)return null;var h=function(e){return-1!==a.indexOf(e)?" checked":""};return c.a.createElement("div",{className:"completion-reqs"},c.a.createElement("h3",null,"Completion Requirements:"),f&&c.a.createElement(H,null),!f&&c.a.createElement("div",null,function(){var e=[];return void 0!==t.activities&&(e=Object(E.a)(t.activities)),t.comments&&e.push("commented"),t.userUpload&&e.push("userUpload"),t.instructorReview&&e.push("instructorReview"),e.map((function(e){return"commented"===e?{id:e,title:"Commented"}:"userUpload"===e?{id:e,title:"User Upload"}:"instructorReview"===e?{id:e,title:"Coach Review"}:{id:e,title:u[e].base.title?u[e].base.title[y()]:u[e].base.id}}))}().map((function(e){var t=e.id,n=e.title;return c.a.createElement("div",{id:t,key:t,className:"admin-checkbox-item",role:"button",onClick:function(){return function(e){var t=a;-1!==a.indexOf(e)?t.splice(a.indexOf(e),1):t.push(e),i(t)}(t)},tabIndex:0},c.a.createElement("div",{className:"admin-checkbox".concat(h(t))},c.a.createElement("div",{className:"check"})),c.a.createElement("div",{className:"checkbox-label"},n))}))))},he=function(e){var t=e.activityData,a=e.template,i=e.mode,r=j(),s=Object(l.a)(r,2),m=s[0],d=s[1],v=Object(n.useState)(d()),f=Object(l.a)(v,2),p=f[0],E=f[1],y=Object(n.useState)(!1),h=Object(l.a)(y,2),O=h[0],g=h[1],I=Object(n.useState)(null),k=Object(l.a)(I,2),S=k[0],C=k[1],T=N("POST-FORM","admin/fileUpload"),w=b(),A=se(),P=Object(l.a)(A,4),x=P[0],D=(P[1],P[2]),U=P[3],L=Object(n.useState)(t||x.activityMap[x.editActivityId].base),R=Object(l.a)(L,2),M=R[0],G=R[1],F=Object(n.useState)(!1),_=Object(l.a)(F,2),B=_[0],J=_[1],q=Object(o.e)(),V=N("GET","admin/exportActivity"),H=Object(n.useState)(!1),K=Object(l.a)(H,2),z=K[0],Q=K[1],$=Object(n.useState)(!1),X=Object(l.a)($,2),Z=X[0],ee=X[1],te=Object(n.useState)(!1),ae=Object(l.a)(te,2),ne=ae[0],ce=ae[1],ie=[{label:"English (US)",value:"en-US"},{label:"Espa\xf1ol (LA)",value:"es-LA"}];Object(n.useEffect)((function(){var e=Object(u.a)({},M),t=!0;a.fields.forEach((function(a){switch(a.type){case"TranslatableInput":case"TranslatableTextArea":"undefined"===typeof e[a.id]&&(e[a.id]=function(e){var t={};return ie.forEach((function(a){t[a.value]=e.default})),t}(a),t=!1);break;case"File":break;default:"undefined"===typeof e[a.id]&&(e[a.id]=a.default,t=!1)}})),t?g(!0):G(e)}),[M,ie,a.fields]);var re=Object(n.useCallback)((function(e,t,a){var n;n="id"===e?t.replace(/\s/g,"-"):t;var c=Object(u.a)({},M);a?(c[e]||(c[e]={}),c[e]=Object(u.a)({},c[e]),c[e][p]=n):c[e]=n,G(c)}),[M,p]),le=Object(n.useCallback)((function(e,t){re(e,t,!0)}),[re]),oe=Object(n.useCallback)((function(e,t){re(e,t,!1)}),[re]),ue=function(e,t){var a=new Date,n=a.getMonth()+1;return"".concat(w.endpoint,"uploads/").concat(a.getFullYear(),"-").concat(n,"/").concat(e,".").concat(t)},me=function(e,t){var a,n="edit"===i&&"id"===e.id;return a=t?(M[e.id]||{})[p]||"":M[e.id]||"",c.a.createElement("div",{id:e.id,key:e.id,className:"admin-input"},c.a.createElement("div",{className:"label"},e.label[p]),c.a.createElement("input",{disabled:n,type:"text",name:e.id,onChange:function(a){return re(e.id,a.target.value,t)},value:a,autoComplete:"off"}))},de=function(e){var t=M[e.id];return c.a.createElement("div",{id:e.id,key:e.id,className:"admin-input"},c.a.createElement("input",{type:"checkbox",id:e.id,name:e.id,value:e.id,checked:t,onChange:function(t){return function(t){console.log(M[e.id]),re(e.id,t.target.checked,!1)}(t)},className:"form-checkbox"}),c.a.createElement("label",{htmlFor:e.id},e.label[p]))},ve=function(e){switch(e.type){case"Input":return me(e,!1);case"TranslatableInput":return me(e,!0);case"TranslatableTextArea":return c.a.createElement("div",{key:e.id,className:"admin-input"},c.a.createElement("div",{className:"label"},e.label[p]),c.a.createElement(Y,{key:e.id+p,id:e.id,initialText:M[e.id][p],onChange:le}));case"Toggle":return de(e);case"QuestionList":return c.a.createElement(pe,{key:e.id,editLanguage:p,languages:ie,listData:M[e.id],onChange:function(t){return re(e.id,t,!1)}});case"PollOptionList":return c.a.createElement(be,{key:e.id,editLanguage:p,languages:ie,listData:M[e.id],onChange:function(t){return re(e.id,t,!1)}});case"File":return c.a.createElement("div",{key:e.id,className:"admin-input"},c.a.createElement(W,{onChange:function(e){return C(t=e),void re("url",ue(M.id,t.name.split(".").pop()),!1);var t},accept:".pdf, .txt, .doc, image/*, video/*, audio/*"}),c.a.createElement("div",{className:"admin-file-note"},m("AdminFileSizeLimit")));case"CompletionReqsList":return c.a.createElement(ye,{key:M.id,activityData:M,completionIds:M.completionReqs,onChange:function(t){return re(e.id,t,!1)}});case"Date":return c.a.createElement("div",{id:e.id,key:e.id,className:"admin-input"},c.a.createElement("div",{className:"label"},e.label[p]),c.a.createElement("input",{id:"startDate",type:"date",value:M[e.id||""],onChange:function(t){oe(e.id,t.target.value)}}));default:return c.a.createElement("div",{key:e.id},e.type)}};return O?c.a.createElement("div",{className:"step"},B&&c.a.createElement("div",{className:"message-wrapper submitting"},c.a.createElement("div",{className:"message"},m("ActivityMessageSubmiting"))),z&&c.a.createElement("div",{className:"message-wrapper submitting"},c.a.createElement("div",{className:"message"},m("ExportMessage"))),Z&&c.a.createElement("div",{onClick:function(){return ee(!1)},role:"button",tabIndex:0,onKeyDown:function(e){13===e.which&&ee(!1)},className:"message-wrapper submitting"},c.a.createElement("div",{className:"message"},c.a.createElement("span",{className:"success"},"\u2714 "),m("ExportSuccess"))),ne&&c.a.createElement("div",{onClick:function(){return ce(!1)},role:"button",tabIndex:0,onKeyDown:function(e){13===e.which&&ce(!1)},className:"message-wrapper submitting"},c.a.createElement("div",{className:"message"},c.a.createElement("span",{className:"fail"},"\u2718 "),m("ExportFail"))),c.a.createElement("h3",null,m("EditActivityContent")),c.a.createElement("div",{className:"admin-form-body"},c.a.createElement("div",null,c.a.createElement("div",{className:"label"},m("EditActivityDetailsLanguageSelect")),c.a.createElement("select",{className:"admin-select-language",onChange:function(e){return E(e.target.value)},value:p},ie.map((function(e){return c.a.createElement("option",{key:e.value,value:e.value},e.label)})))),c.a.createElement("div",{className:"edit-form"},a.fields.map((function(e){return ve(e)})),c.a.createElement(Ee,{onChange:function(e){return re("journeys",e,!1)}})),c.a.createElement("button",{type:"button",className:"admin-activity-button admin-form-continue-button",onClick:function(){J(!0);var e=M;if(e.lastUpdated=(new Date).toISOString(),e.activities||(e.activities=[]),e.id)if(S){var t=new FormData;t.append("file",S);var a=[{key:"activityId",value:e.id},{key:"fileName",value:e.id}];T(a,t).then((function(t){e.url="".concat(w.endpoint).concat(t),D(e.id,e).then((function(){J(!1)}))})).catch((function(e){console.error(e)}))}else"add"===i?D(e.id,e,!0).then((function(){q.push("/admin/editActivity?activityId=".concat(w.activityPath+e.id))})):D(e.id,e).then((function(){J(!1)}));else alert(m("AddActivityIdError"))}},m("SubmitButton")),c.a.createElement("button",{type:"button",className:"admin-activity-button admin-form-submit-button",onClick:function(){window.confirm(m("RemoveActivityWarning"))&&U(M.id)}},"Remove"),"journey"===M.activityType&&c.a.createElement("button",{type:"button",className:"admin-activity-button admin-form-submit-button",onClick:function(){window.open("/admin/preview?journeyId=".concat(x.activityId,"&activityId=").concat(x.editActivityId))}},"Preview"),"journey"===M.activityType&&c.a.createElement("button",{type:"button",className:"admin-activity-button admin-form-submit-button",onClick:function(){return function(){Q(!0);var e="".concat("http://50.229.61.229:2120/","admin/exportActivity?activityId=").concat(w.activityPath).concat(M.id);V([{key:"activityId",value:e}]).then((function(){Q(!1),ee(!0)})).catch((function(e){Q(!1),ce(!0)}))}()}},"Export"))):null},Oe=(a(42),function(e){Object(de.a)(e);var t=Object(n.useState)("SelectTemplate"),a=Object(l.a)(t,2),i=a[0],r=a[1],s=Object(n.useState)(null),o=Object(l.a)(s,2),u=o[0],m=o[1],d=Object(n.useState)(null),v=Object(l.a)(d,2),f=v[0],p=v[1],b=Object(n.useState)(!1),E=Object(l.a)(b,2),y=E[0],h=(E[1],Object(n.useState)(!1)),O=Object(l.a)(h,2),g=O[0],N=O[1],I=j(),k=Object(l.a)(I,1)[0],S=function(e,t){var a=f||{};a.activityType=t,p(a),m(e),r("EditDetails")},C=function(){N(!1)},T=function(e){return e===i?" active":""};return c.a.createElement("div",{className:"editor add-activity"},c.a.createElement("div",{className:"step-list"},c.a.createElement("div",{className:"step-link".concat(T("SelectTemplate")),onClick:function(){return r("SelectTemplate")},role:"button",tabIndex:0,onKeyDown:function(e){13===e.which&&r("SelectTemplate")}},k("AddActivityStep1")),c.a.createElement("div",{className:"step-link".concat(T("EditDetails")),onClick:function(){return r("EditDetails")},role:"button",tabIndex:0,onKeyDown:function(e){13===e.which&&r("EditDetails")}},k("AddActivityStep2"))),function(e){switch(e){case"SelectTemplate":return c.a.createElement(ve,{onSelect:S});case"EditDetails":return u?c.a.createElement(he,{activityData:f,mode:"add",template:u}):null;default:return c.a.createElement(ve,{onSelect:S})}}(i),y&&c.a.createElement("div",{className:"message-wrapper submitting"},c.a.createElement("div",{className:"message"},k("ActivityMessageSubmiting"))),g&&c.a.createElement("div",{className:"message-wrapper failure",onClick:function(){return C()},role:"button",tabIndex:0,onKeyDown:function(e){13===e.which&&C()}},c.a.createElement("div",{className:"message"},k("AddActivityMessageFail"))))}),ge=function(e){var t=e.onChange,a=Object(n.useState)("all"),i=Object(l.a)(a,2),r=i[0],s=i[1],o=j(),u=Object(l.a)(o,2)[1];return Object(n.useEffect)((function(){t("all"!==r?[{type:"term",key:"activityType",value:r}]:[])}),[r,t]),c.a.createElement("select",{className:"search-filter select-activity-type",onChange:function(e){return s(e.target.value)},value:r},[{label:{"en-US":"All","es-LA":"(ES) All"},value:"all"},{label:{"en-US":"Journey","es-LA":"(ES) Journey"},value:"journey"}].map((function(e){return c.a.createElement("option",{key:e.value,value:e.value},e.label[u()])})))},je=function(e){var t=e.onComplete,a=e.parentActivity,i=Object(n.useState)(null),r=Object(l.a)(i,2),s=r[0],o=r[1],u=Object(n.useState)(""),m=Object(l.a)(u,2),d=m[0],v=m[1],f=Object(n.useState)(!1),p=Object(l.a)(f,2),E=p[0],y=p[1],h=Object(n.useState)(!1),O=Object(l.a)(h,2),g=O[0],I=O[1],k=j(),S=Object(l.a)(k,1)[0],C=N("POST","admin/activity"),T=N("GET","activity/getActivity"),w=b(),A=function(){if(s&&""!==d){y(!0);var e={id:d,activityType:s,activities:[]},a=w.activityPath+e.id;C([{key:"activityId",value:a}],[{type:"base",data:e}]).then((function(){t(a)})).catch((function(e){y(!1),I(!0)}))}};return c.a.createElement("div",{className:"create-child"},c.a.createElement(ve,{mode:"child",onSelect:function(e,t){o(t)},parentActivity:a}),c.a.createElement("div",{id:"activityId",className:"admin-input"},c.a.createElement("div",{className:"label"},"ID:"),c.a.createElement("input",{type:"text",name:"activityId",onChange:function(e){return function(e){var t=e.replace(/\s/g,"-");v(t)}(e.target.value)},value:d,autoComplete:"off",pattern:"^[a-zA-Z0-9]+$"})),c.a.createElement("button",{type:"button",className:"admin-form-submit-button",onClick:function(){!function(){var e=[{key:"activityId",value:w.activityPath+d},{key:"profileId",value:w.profileIds.base}];T(e).then((function(e){e.data.base&&alert(S("adminRestrictDuplicateIds")),null===e.data.base&&A()})).catch((function(e){console.error(e)}))}()}},S("StructureSubmitActivity")),E&&c.a.createElement("div",{className:"message-wrapper submitting"},c.a.createElement("div",{className:"message"},S("ActivityMessageSubmiting"))),g&&c.a.createElement("div",{className:"message-wrapper failure",onClick:function(){I(!1)}},c.a.createElement("div",{className:"message"},S("AddActivityMessageFail"))))},Ne=(a(459),function(e){var t=e.onChange,a=e.activityData,i=Object(n.useState)(!0),r=Object(l.a)(i,2),s=r[0],o=r[1],u=Object(n.useState)([]),m=Object(l.a)(u,2),d=m[0],v=m[1],f=Object(n.useState)([]),p=Object(l.a)(f,2),b=p[0],y=p[1],h=Object(n.useState)({}),O=Object(l.a)(h,2),g=O[0],I=O[1],k=Object(n.useState)([]),S=Object(l.a)(k,2),C=S[0],T=S[1],w=Object(n.useState)([]),A=Object(l.a)(w,2),P=A[0],x=A[1],D=Object(n.useState)("search"),U=Object(l.a)(D,2),L=U[0],R=U[1],M=N("GET","admin/activities"),G=j(),F=Object(l.a)(G,2),_=F[0],B=F[1];Object(n.useEffect)((function(){var e=a.activities||[];o(!0),y(e)}),[a]),Object(n.useEffect)((function(){var e=C.map((function(e){return e}));x(e)}),[C]),Object(n.useEffect)((function(){var e=Object(E.a)(b);if(P.forEach((function(t){-1===e.indexOf(t)&&e.push(t)})),0!==e.length){var t=[{key:"activityIds",value:JSON.stringify(e)}];M(t).then((function(e){I(e.data),o(!1)}))}else o(!1)}),[b,P,M]);var J=function(e){if(a.id!==e.split("/")[e.split("/").length-1]){var n=Object(E.a)(b);if(n.push(e),y(n),"exercise"===a.activityType){var c=a.completionReqs;c.push(e),t(n,c)}t(n)}else alert(_("adminRestrictChildofSelf"))},q=function(e){var n=Object(E.a)(b);if(n.push(e),y(n),"exercise"===a.activityType){var c=a.completionReqs;c.push(e),t(n,c)}t(n)},V=function(e,n){if(s||!g[e])return null;var i=g[e].base,r=i.title?i.title[B()]:"* ".concat(i.id);return c.a.createElement("div",{key:n,className:"item child-activity"},c.a.createElement("div",{className:"label"},c.a.createElement("div",{className:"activity-title"},r),c.a.createElement("div",{className:"activity-id"},i.id)),c.a.createElement("button",{type:"button",className:"remove-button",onClick:function(){return function(e){var n=Object(E.a)(b);if(n.splice(e,1),y(n),"exercise"===a.activityType){var c=a.completionReqs;c.splice(e,1),t(n,c)}t(n)}(n)}},c.a.createElement("div",{className:"icon"})),c.a.createElement("div",{className:"controls"},c.a.createElement("button",{type:"button",onClick:function(){return function(e){if(0!==e){var a=Object(E.a)(b),n=a[e];a[e]=a[e-1],a[e-1]=n,y(a),t(a)}}(n)},className:"up"},c.a.createElement("div",{className:"icon"})),c.a.createElement("button",{type:"button",onClick:function(){return function(e){if(e!==b.length-1){var a=Object(E.a)(b),n=a[e];a[e]=a[e+1],a[e+1]=n,y(a),t(a)}}(n)},className:"down"},c.a.createElement("div",{className:"icon"}))))},H=function(e){if(s||!g[e]||null===g[e].base)return null;var t=g[e].base,n=(null===t||void 0===t?void 0:t.title)?t.title[B()]:(null===t||void 0===t?void 0:t.id)||"No Title Found",i=[];switch(null===a||void 0===a?void 0:a.activityType){case"journey":i=["milestone"];break;case"milestone":i=["exercise"];break;case"exercise":i=["resource","assessment","poll"]}return-1===i.indexOf(null===t||void 0===t?void 0:t.activityType)?null:c.a.createElement("div",{key:e,className:"result-activity add-activity"},c.a.createElement("div",{className:"label"},c.a.createElement("div",{className:"activity-title"},n),c.a.createElement("div",{className:"activity-id"},t.id)),c.a.createElement("button",{type:"button",className:"add-button",onClick:function(){return function(e){var t=a.activityType,n=g[e].base.activityType;"journey"===t&&("milestone"===n?J(e):alert(_("adminRestrictChildTypes"))),"milestone"===t&&("exercise"===n?J(e):alert(_("adminRestrictChildTypes"))),"exercise"===t&&("poll"===n||"assessment"===n||"resource"===n?J(e):alert(_("adminRestrictChildTypes")))}(e)}},c.a.createElement("div",{className:"icon"})))},K=function(e){return e===L?" active":""};return c.a.createElement("div",{className:"step"},c.a.createElement("h3",null,_("EditStructureTitle")),c.a.createElement("div",{className:"admin-form-body"},c.a.createElement("div",{className:"edit-form"},c.a.createElement("div",{className:"edit-form-panel item-list child-list"},c.a.createElement("h4",null,_("StructureCurrentChildren")),c.a.createElement("div",{className:"child-activities-container"},0===b.length&&c.a.createElement("div",{className:"no-children"},_("StructureNoChildrenMessage")),b.map((function(e,t){return V(e,t)})))),c.a.createElement("div",{className:"edit-form-panel"},c.a.createElement("h4",null,_("StructureAddNewChildren")),c.a.createElement("div",{className:"add-option-list"},c.a.createElement("span",{className:"add-option".concat(K("search")),onClick:function(){R("search")}},"Search"),c.a.createElement("span",{className:"add-option".concat(K("create")),onClick:function(){R("create")}},"Create")),function(){switch(L){case"search":return c.a.createElement("div",{className:"tab search-tab"},_("StructureSearchInclude"),c.a.createElement(ge,{onChange:v}),c.a.createElement("br",null),_("StructureSearchTitle"),c.a.createElement("div",{className:"search-input"},c.a.createElement(z,{route:"admin/searchActivities",filters:d,onResults:T})),c.a.createElement("div",{className:"search-results"},c.a.createElement("div",{className:"child-activities-container"},0===P.length&&c.a.createElement("div",{className:"no-children"},_("StructureSearchResultsMessage")),P.map((function(e){return H(e)})))));case"create":return c.a.createElement("div",{className:"tab create-tab"},c.a.createElement(je,{onComplete:q,parentActivity:a}))}}()))))}),Ie=function(){var e=N("GET","admin/activityTemplate"),t=Object(n.useState)("EditDetails"),a=Object(l.a)(t,2),i=a[0],r=a[1],s=Object(n.useState)(null),o=Object(l.a)(s,2),m=o[0],d=o[1],v=Object(n.useState)(!1),f=Object(l.a)(v,2),p=f[0],b=f[1],E=Object(n.useState)(!1),y=Object(l.a)(E,2),h=y[0],O=y[1],g=j(),I=Object(l.a)(g,1)[0],k=se(),S=Object(l.a)(k,3),C=S[0],T=S[2],w=C.activityMap[C.editActivityId].base;Object(n.useEffect)((function(){d(null)}),[w]),Object(n.useEffect)((function(){if(w&&w.activityType){var t=[{key:"templateId",value:w.activityType}];e(t).then((function(e){d(e.data)})).catch((function(e){console.error(e)}))}}),[w,e]);var A=function(e,t){var a=Object(u.a)({},w);a.activities=e,a.lastUpdated=(new Date).toISOString(),t&&(a.completionReqs=t),P(a)},P=function(e){b(!0),T(e.id,e).then((function(){b(!1)}))},x=function(e){return e===i?" active":""};if(!w||!m)return null;return c.a.createElement("div",{className:"editor add-activity"},c.a.createElement("div",{className:"step-list"},c.a.createElement("div",{className:"step-link".concat(x("EditDetails")),onClick:function(){return r("EditDetails")}},I("EditActivityStep2")),"journey"===w.activityType||"milestone"===w.activityType||"exercise"===w.activityType?c.a.createElement("div",{className:"step-link".concat(x("EditStructure")),onClick:function(){return r("EditStructure")}},I("EditActivityStep3")):null),function(e){if("poll"===w.activityType||"resource"===w.activityType||"assessment"===w.activityType)return c.a.createElement(he,{template:m,mode:"edit"});switch(e){case"EditDetails":return c.a.createElement(he,{template:m,mode:"edit"});case"EditStructure":return c.a.createElement(Ne,{onChange:A,activityData:w});default:return c.a.createElement(he,{template:m,mode:"edit"})}}(i),p&&c.a.createElement("div",{className:"message-wrapper submitting"},c.a.createElement("div",{className:"message"},I("ActivityMessageSubmiting"))),h&&c.a.createElement("div",{className:"message-wrapper failure",onClick:function(){O(!1)}},c.a.createElement("div",{className:"message"},I("EditActivityMessageFail"))))},ke=function(e){var t=e.onComplete,a=Object(n.useState)([]),i=Object(l.a)(a,2),r=i[0],s=i[1],o=Object(n.useState)([]),u=Object(l.a)(o,2),m=u[0],d=u[1],v=Object(n.useState)([]),f=Object(l.a)(v,2),p=f[0],b=f[1],E=Object(n.useState)(!0),y=Object(l.a)(E,2),h=y[0],O=y[1],g=Object(n.useState)({}),I=Object(l.a)(g,2),k=I[0],S=I[1],C=N("GET","admin/activities"),T=j(),w=Object(l.a)(T,2),A=w[0],P=w[1];Object(n.useEffect)((function(){O(!0),b(m)}),[m]),Object(n.useEffect)((function(){if(0!==p.length){var e=[{key:"activityIds",value:JSON.stringify(p)}];C(e).then((function(e){S(e.data),O(!1)}))}else O(!1)}),[C,p]);var x=function(e){if(h||!k[e])return null;var a=k[e].base;return c.a.createElement("button",{key:e,type:"button",className:"result-activity select-activity",onClick:function(){return t(e)}},c.a.createElement("div",{className:"label"},function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return e&&e[t]&&e[t][P()]||a}(a,"title",e)))};return c.a.createElement("div",{className:"step"},c.a.createElement("div",{className:"admin-form-body"},A("ActivitySearchInclude"),c.a.createElement(ge,{onChange:s}),c.a.createElement("br",null),A("ActivitySearchParams"),c.a.createElement("div",{className:"search-input"},c.a.createElement(z,{route:"admin/searchActivities",filters:r,onResults:d})),c.a.createElement("div",{className:"search-results"},c.a.createElement("div",{className:"child-activities-container"},0!==p.length&&c.a.createElement("div",null,A("ActivitySearchSelect")),0===p.length&&c.a.createElement("div",{className:"no-children"},A("ActivitySearchResultsMessage")),p.map((function(e){return x(e)}))))))},Se=function(){var e=se(),t=Object(l.a)(e,2),a=t[0],i=t[1],r=a.activityId,s=a.activityMap,o=a.editActivityId,u=j(),m=Object(l.a)(u,2)[1];Object(n.useEffect)((function(){d(s[r].base.id)}),[]);var d=function(e,t){t&&t.stopPropagation();var a=document.getElementById(e),n=document.getElementById("collapse-id-".concat(e));a&&n&&(a.classList.contains("open")?(a.classList.remove("open"),n.classList.remove("open")):(a.classList.add("open"),n.classList.add("open")))};return c.a.createElement("div",{className:"activity-map"},function e(t,a){if(!s[t])return null;var n=s[t].base,r=n.title?n.title[m()]:"* ".concat(n.id);return c.a.createElement("div",{key:t,className:"map-activity level-".concat(a)},c.a.createElement("div",{className:"map-activity-label".concat(t===o?" active":""),role:"button",onClick:function(){return i({editActivityId:t})}},c.a.createElement("div",{className:"activity-name"},r),n.activities.length>0&&c.a.createElement("div",{id:"collapse-id-".concat(n.id),className:"collapse",role:"button",onClick:function(e){return d(n.id,e)}})),c.a.createElement("div",{className:"map-activity-children",id:n.id},n.activities.map((function(t){return e(t,a+1)}))))}(r,0))},Ce=function(){var e=new URLSearchParams(Object(o.f)().search).get("activityId"),t=se(),a=Object(l.a)(t,2),i=a[0],r=a[1],s=i.activityId,u=i.activityMap,m=i.editActivityId,d=Object(n.useState)(!0),v=Object(l.a)(d,2),f=v[0],p=v[1];Object(n.useEffect)((function(){e?(r({activityId:e}),""!==s&&p(!1)):p(!1)}),[e,s]);return c.a.createElement("div",null,f&&c.a.createElement(H,null),!f&&""===s&&c.a.createElement("div",{className:"editor edit-map"},c.a.createElement(ke,{onComplete:function(e){r({activityId:e})}})),""!==s&&c.a.createElement("div",{className:"editor edit-map"},c.a.createElement(Se,null),c.a.createElement("div",{className:"selected-activity-editor"},m&&u[m]&&c.a.createElement(Ie,null))))},Te=function(){var e,t=Object(n.useState)(null),a=Object(l.a)(t,2),i=a[0],r=a[1],s=Object(n.useState)(""),o=Object(l.a)(s,2),u=o[0],m=o[1],d=Object(n.useState)(null),v=Object(l.a)(d,2),f=v[0],p=v[1],y=Object(n.useState)(!1),h=Object(l.a)(y,2),O=h[0],g=h[1],I=Object(n.useState)(!1),k=Object(l.a)(I,2),S=k[0],C=k[1],T=N("GET","activity/getActivity"),w=N("POST","admin/activity"),A=b(),P=j(),x=Object(l.a)(P,1)[0],D=G().userData,U=function(e,t){var a;(g(!0),"add"===e&&(a=function(){var e=f.base,t=D.userProfiles[A.profileIds.base].language,a={id:(new Date).valueOf(),date:(new Date).toISOString(),content:{}};return a.content[t]=u,void 0!==e.alerts?e.alerts.push(a):e.alerts=[a],e}()),"remove"===e&&t&&(a=function(e){var t=f.base,a=Object(E.a)(t.alerts),n=a.find((function(t){return t.id===e}));return a.splice(a.indexOf(n),1),t.alerts=a,t}(t)),a)?w([{key:"activityId",value:i}],[{type:"base",data:a}]).then((function(){g(!1),m("")})).catch((function(e){g(!1),console.warn(e)})):setTimeout((function(){g(!1),alert(x("AnnouncementUpdateError"))}),5e3)};return c.a.createElement("div",{className:"add-announcement"},c.a.createElement("h2",null,x("AnnouncementJourneyTitle")),c.a.createElement("p",null,x("AnnouncementJourneyText")),!i&&c.a.createElement("div",{className:"editor edit-map"},c.a.createElement(ke,{onComplete:function(e){C(!0),r(e),T([{key:"activityId",value:e},{key:"profileId",value:"base"}]).then((function(e){p(e.data),C(!1)})).catch((function(e){console.warn("Error getting activity for announcements")}))}})),i&&c.a.createElement("div",{className:"announcement-container admin-form-body admin-input"},c.a.createElement("div",null,c.a.createElement("p",null,x("AnnouncementContentHeader")),c.a.createElement("input",{onChange:function(e){return function(e){m(e)}(e.target.value)},value:u}),c.a.createElement("div",{className:"announcement-button-container"},c.a.createElement("button",{type:"button",className:"admin-form-submit-button",onClick:function(){return r(null)}},x("BackButton")),c.a.createElement("button",{type:"button",className:"admin-form-submit-button",onClick:function(){return U("add")}},x("SubmitButton")))),c.a.createElement("hr",null),S&&c.a.createElement(H,{colorTheme:"dark"}),!S&&c.a.createElement("div",null,c.a.createElement("h3",null,"Current Announcements"),null===(e=f.base.alerts)||void 0===e?void 0:e.map((function(e){return c.a.createElement("div",{className:"announcement",key:e.id},c.a.createElement("div",null,c.a.createElement("div",{className:"message"},function(e){var t=D.userProfiles[A.profileIds.base].language;return"string"===typeof e?e:e[t]?e[t]:void 0===e[t]?e[Object.keys(e)[0]]:x("AnnouncementMessageMissing")}(e.content)),c.a.createElement("div",{className:"timestamp"},e.date)),c.a.createElement("div",{onClick:function(){return t=e.id,void(window.confirm(x("AnnouncementRemoveConfirm"))&&U("remove",t));var t},className:"remove-announcement",role:"button",tabIndex:0},"\xd7"))})))),O&&c.a.createElement("div",{className:"editor"},c.a.createElement("div",{className:"message-wrapper submitting"},c.a.createElement("div",{className:"message"},x("ActivityMessageSubmiting")))))},we=function(e){var t=e.onComplete,a=(Object(n.useRef)(null),j()),i=Object(l.a)(a,1)[0],r=Object(n.useState)(),s=Object(l.a)(r,2),o=s[0],u=s[1];return c.a.createElement("div",{className:"step"},c.a.createElement("h2",null,i("AddUsersUpload")),c.a.createElement(W,{onChange:u,accept:".csv"}),c.a.createElement("button",{type:"button",className:"continue basic-button",onClick:function(e){o&&t(o)}},i("ContinueButton")))},Ae=a(129),Pe=function(e){var t=e.onComplete,a=e.csvInput,i=N("PUT","admin/user"),r=Object(n.useState)([]),s=Object(l.a)(r,2),o=s[0],u=s[1],m=Object(n.useState)(!1),d=Object(l.a)(m,2),v=d[0],f=d[1],p=Object(n.useState)([]),b=Object(l.a)(p,2),y=b[0],h=b[1],O=Object(n.useState)([]),g=Object(l.a)(O,2),I=g[0],k=g[1],S=Object(n.useState)(-1),C=Object(l.a)(S,2),T=C[0],w=C[1],A=j(),P=Object(l.a)(A,1)[0],x=G().userData;Object(n.useEffect)((function(){if(a){var e=Ae.parse(a).reduce((function(e,t,a){if(a>0){var n={username:String(t[0]),language:t[1],name:t[2],email:t[3],group:t[4]};e.push(n)}return e}),[]);u(e)}}),[a]),Object(n.useEffect)((function(){var e=o.length-y.length-I.length;w(e)}),[o,y,I]),Object(n.useEffect)((function(){0===T&&v&&t()}),[v,t,T]);var D=function(e){var t=e;return t=(t=t.replace(" ","")).replace('"',"")};return c.a.createElement("div",{className:"step"},!v&&c.a.createElement("div",{className:"submit-new-user-form"},c.a.createElement("h2",null,P("SubmitNewTitle")),c.a.createElement("p",null,P("SubmitNewDescription1")+o.length+P("SubmitNewDescription2")),c.a.createElement("button",{type:"button",className:"submit basic-button",onClick:function(){f(!0);var e=[],t=[];o.forEach((function(a,n){setTimeout((function(){var n=function(e){var t={username:D(e.username)},a=[e.group];return{userData:t,profiles:[{type:x.profileIds.base,data:{language:e.language,name:e.name,email:e.email}},{type:x.profileIds.app,data:{roles:["user"],groups:a}}]}}(a);i([],n).then((function(t){e=[].concat(Object(E.a)(e),[a]),h(e)})).catch((function(e){console.error(e),t=[].concat(Object(E.a)(t),[a]),k(t)}))}),1e3*n+1)}))}},P("SubmitButton"))),v&&c.a.createElement("div",{className:"submit-new-user-form"},c.a.createElement("h2",null,P("SubmitNewProgressTitle")),P("SubmitNewProgressDescription"),c.a.createElement("div",{className:"progress-panel"},c.a.createElement("div",{className:"progress remaining"},P("SubmitNewRemaining")+T),c.a.createElement("div",{className:"progress success"},P("SubmitNewMessageSuccess")+y.length),c.a.createElement("div",{className:"progress failure"},P("SubmitNewMessageFail")+I.length))))},xe=function(){N("PUT","admin/users");var e=Object(n.useState)(1),t=Object(l.a)(e,2),a=t[0],i=t[1],r=Object(n.useState)(null),s=Object(l.a)(r,2),u=s[0],m=s[1],d=Object(n.useState)(!1),v=Object(l.a)(d,2),f=v[0],p=v[1],b=Object(n.useState)(!1),E=Object(l.a)(b,2),y=E[0],h=E[1],O=Object(o.e)(),g=j(),I=Object(l.a)(g,1)[0],k=function(e){var t=new FileReader;t.onload=function(e){m(e.target.result),i(2)},t.readAsText(e)},S=function(e){p(!0)},C=function(e){var t="step-link";return a>=e&&(t+=" enabled"),a===e&&(t+=" active"),t},T=function(e){a>=e&&i(e)};return c.a.createElement("div",{className:"editor add-users"},c.a.createElement("div",{className:"step-list"},c.a.createElement("div",{className:C(1),onClick:function(){return T(1)}},I("AddUsersUpload")),c.a.createElement("div",{className:C(2),onClick:function(){return T(2)}},I("SubmitButton"))),function(e){switch(e){case 1:return c.a.createElement(we,{onComplete:k});case 2:return c.a.createElement(Pe,{onComplete:S,csvInput:u});default:return c.a.createElement(we,{onComplete:k})}}(a),f&&c.a.createElement("div",{className:"message-wrapper success",onClick:function(){O.push("/admin")}},c.a.createElement("div",{className:"message"},I("AddUsersMessageSuccess"))),y&&c.a.createElement("div",{className:"message-wrapper failure",onClick:function(){h(!1)}},c.a.createElement("div",{className:"message"},I("AddUsersMessageFail"))))},De=function(e){var t=e.onComplete,a=Object(n.useState)(""),i=Object(l.a)(a,2),r=i[0],s=i[1],o=Object(n.useState)(!1),u=Object(l.a)(o,2),m=u[0],d=u[1],v=N("GET","admin/user"),f=j(),p=Object(l.a)(f,1)[0],b=function(){v([{key:"username",value:r}]).then((function(e){t(e.data.profiles,r)})).catch((function(e){d(!0)}))};return c.a.createElement("div",{className:"step"},c.a.createElement("h2",null,p("SearchForUserTitle")),c.a.createElement("div",{className:"edit-form-panel"},p("SearchForUserDesc"),c.a.createElement("div",{className:"search-input admin-input"},c.a.createElement("input",{onChange:function(e){s(e.target.value)},onKeyDown:function(e){13===e.which&&b()}}),c.a.createElement("button",{onClick:function(){return b()},type:"button",className:"admin-activity-button admin-form-submit-button inline"},p("searchLabel")))),m&&c.a.createElement("div",{className:"message-wrapper failure",onClick:function(){d(!1)}},c.a.createElement("div",{className:"message"},p("SearchMessageFail"))))},Ue=(a(473),function(e){var t=e.onComplete,a=e.initialProfiles,i=j(),r=Object(l.a)(i,2),s=r[0],o=(r[1],Object(n.useState)(a)),m=Object(l.a)(o,2),d=m[0],v=m[1],f=b().roles,p=G().userData,E=function(e){var t=Object(u.a)({},d),a=e.target.value,n=e.target.checked,c=t[p.profileIds.app].roles;n?-1===c.indexOf(a)&&c.push(a):c.indexOf(a)>-1&&c.splice(c.indexOf(a),1),t[p.profileIds.app].roles=c,v(t)};return d?c.a.createElement("div",{className:"step"},c.a.createElement("h3",null,s("EditUserTitle")),c.a.createElement("div",{className:"admin-form-body"},c.a.createElement("fieldset",null,c.a.createElement("legend",null,s("EditUserRoleTitle")),f.map((function(e){var t=d[p.profileIds.app].roles.indexOf(e)>-1;return c.a.createElement("div",{className:"role-inputs",key:e},c.a.createElement("input",{type:"checkbox",id:e,name:"role",value:e,checked:t,onChange:E}),c.a.createElement("label",{htmlFor:e},s("role".concat(e))))}))),c.a.createElement("button",{type:"button",className:"admin-form-continue-button",onClick:function(){t(d)}},s("ContinueButton")))):null}),Le=function(e){var t=e.onComplete,a=e.userProfiles,i=G().userData,r=Object(n.useState)(a[i.profileIds.app].groups||[]),s=Object(l.a)(r,2),o=s[0],u=s[1],m=Object(n.useState)(a[i.profileIds.app].instructedGroups||[]),d=Object(l.a)(m,2),v=d[0],f=d[1],p=Object(n.useState)(""),b=Object(l.a)(p,2),y=b[0],h=b[1],O=Object(n.useState)(""),g=Object(l.a)(O,2),N=g[0],I=g[1],k=j(),S=Object(l.a)(k,1)[0],C=function(){T(y)},T=function(e){var t=Object(E.a)(o);t.push(e),u(t)},w=function(){A(N)},A=function(e){var t=Object(E.a)(v);t.push(e),f(t)},P=function(e,t){return c.a.createElement("div",{key:t,className:"item group"},c.a.createElement("div",{className:"label"},e),c.a.createElement("button",{type:"button",className:"remove-button",onClick:function(){return function(e){var t=Object(E.a)(o);t.splice(e,1),u(t)}(t)}},c.a.createElement("div",{className:"icon"})))},x=function(e,t){return c.a.createElement("div",{key:t,className:"item group"},c.a.createElement("div",{className:"label"},e),c.a.createElement("button",{type:"button",className:"remove-button",onClick:function(){return function(e){var t=Object(E.a)(v);t.splice(e,1),f(t)}(t)}},c.a.createElement("div",{className:"icon"})))};return c.a.createElement("div",{className:"step"},c.a.createElement("div",{className:"admin-form-body"},c.a.createElement("div",{className:"edit-form assigned"},c.a.createElement("h2",null,S("EditUserGroupsTitle")),c.a.createElement("div",{className:"edit-form-panel item-list group-list"},c.a.createElement("h3",null,S("EditGroupsCurrent")),o.map((function(e,t){return P(e,t)}))),c.a.createElement("div",{className:"edit-form-panel"},c.a.createElement("h3",null,S("EditGroupsAddNew")),c.a.createElement("div",{className:"search-input admin-input"},c.a.createElement("input",{onChange:function(e){h(e.target.value)},onKeyDown:function(e){13===e.which&&C()}}),c.a.createElement("button",{onClick:function(){return C()},type:"button",className:"admin-activity-button admin-form-submit-button inline"},"ADD")))),a[i.profileIds.app].roles.indexOf("instructor")>-1&&c.a.createElement("div",{className:"edit-form instructed"},c.a.createElement("hr",null),c.a.createElement("h2",null,S("EditGroupsInstructedGroupsTitle")),c.a.createElement("div",{className:"edit-form-panel item-list group-list"},c.a.createElement("h3",null,S("EditGroupsInstructed")),v.map((function(e,t){return x(e,t)}))),c.a.createElement("div",{className:"edit-form-panel"},c.a.createElement("h3",null,S("EditGroupsAddNewInstructed")),c.a.createElement("div",{className:"search-input admin-input"},c.a.createElement("input",{onChange:function(e){I(e.target.value)},onKeyDown:function(e){13===e.which&&w()}}),c.a.createElement("button",{onClick:function(){return w()},type:"button",className:"admin-activity-button admin-form-submit-button inline"},"ADD")))),c.a.createElement("button",{type:"button",className:"admin-form-continue-button",onClick:function(){t({assignedIds:o,instructedIds:v})}},S("SubmitButton"))))},Re=a(129),Me=function(e){var t=e.onComplete,a=e.userProfiles,i=Object(n.useState)(""),r=Object(l.a)(i,2),s=r[0],o=r[1],u=Object(n.useState)([]),m=Object(l.a)(u,2),d=m[0],v=m[1],f=Object(n.useState)({}),p=Object(l.a)(f,2),b=p[0],E=p[1],y=N("GET","admin/usersByUsername"),h=G().userData,O=Object(n.useRef)(null);Object(n.useEffect)((function(){a[h.profileIds.app].managedUsers&&v(a[h.profileIds.app].managedUsers);var e=[{key:"usernames",value:JSON.stringify(a[h.profileIds.app].managedUsers||[])}];y(e).then((function(e){E(e.data)})).catch((function(e){console.error(e)}))}),[a]);var g=function(){t(d)};return c.a.createElement("div",null,c.a.createElement("div",{className:"step"},c.a.createElement("div",{className:"admin-form-body"},c.a.createElement("div",{className:"edit-form"},c.a.createElement("div",{className:"edit-form-panel"},c.a.createElement("h4",null,"Add User"),"User ID:",c.a.createElement("div",{className:"admin-input"},c.a.createElement("input",{type:"text",name:"new-group-id",onChange:function(e){return o(e.target.value)},value:s,autoComplete:"off"})),c.a.createElement("button",{type:"button",className:"admin-form-submit-button inline",onClick:function(){var e=d;e.push(s),v(e),g()}},"ADD")),c.a.createElement("div",{className:"edit-form-panel"},c.a.createElement("h4",null,"Batch Add User"),c.a.createElement("span",null,"Upload CSV:"),c.a.createElement("br",null),c.a.createElement("input",{className:"admin-input",type:"file",ref:O,id:"csv-file",name:"csv-file",accept:".csv"}),c.a.createElement("button",{type:"button",className:"admin-form-submit-button",onClick:function(){if(O.current&&O.current.files&&O.current.files.length>0){var e=new FileReader,a=d;e.onload=function(e){var n=Re.parse(e.target.result);a=a.concat(n.flat()),v(a),t(a)},e.readAsText(O.current.files[0])}}},"SUBMIT")),c.a.createElement("div",{className:"edit-form-panel item-list child-list"},c.a.createElement("h4",null,"Current Users"),function(){var e;return c.a.createElement("div",{className:"item-container"},null===(e=Object.keys(b))||void 0===e?void 0:e.map((function(e){var t=b[e];return t?c.a.createElement("div",{key:e,className:"item"},c.a.createElement("div",{className:"label"},t.name),c.a.createElement("button",{type:"button",className:"remove-button",onClick:function(){return function(e){var t=d;t.splice(d.indexOf(e),1),v(t),g()}(e)}},c.a.createElement("div",{className:"icon"}))):null})))}())))))},Ge=function(){N("GET","admin/user");var e=N("POST","admin/user"),t=Object(n.useState)(1),a=Object(l.a)(t,2),i=a[0],r=a[1],s=Object(n.useState)(null),m=Object(l.a)(s,2),d=m[0],v=m[1],f=Object(n.useState)(null),p=Object(l.a)(f,2),b=p[0],E=p[1],y=Object(n.useState)(!1),h=Object(l.a)(y,2),O=h[0],g=h[1],I=Object(n.useState)(!1),k=Object(l.a)(I,2),S=k[0],C=k[1],T=Object(o.e)(),w=j(),A=Object(l.a)(w,1)[0],P=G().userData,x=function(e){return[{type:P.profileIds.base,data:e[P.profileIds.base]},{type:P.profileIds.app,data:e[P.profileIds.app]}]},D=function(e,t){v(t),E(e),r(2)},U=function(e){E(e),r(3)},L=function(e){var t=Object(u.a)({},b);t[P.profileIds.app].groups=e.assignedIds,t[P.profileIds.app].instructedGroups=e.instructedIds,E(t),M(t)},R=function(t){var a=Object(u.a)({},b);a[P.profileIds.app].managedUsers=t,E(a);var n={profiles:x(a)};e([{key:"username",value:d}],n).then((function(e){console.log("update worked"),console.log(b)})).catch((function(e){console.error(e)})),console.log(t)},M=function(t){var a={profiles:x(t)};e([{key:"username",value:d}],a).then((function(e){g(!0)})).catch((function(e){console.error(e),C(!0)}))},F=function(e){var t="step-link";return i>=e&&(t+=" enabled"),i===e&&(t+=" active"),t},_=function(e){i>=e&&r(e),4===e&&r(e)};return c.a.createElement("div",{className:"editor edit-user"},c.a.createElement("div",{className:"step-list"},c.a.createElement("div",{className:F(1),onClick:function(){return _(1)}},A("EditUserStep1")),c.a.createElement("div",{className:F(2),onClick:function(){return _(2)}},A("EditUserStep2")),c.a.createElement("div",{className:F(3),onClick:function(){return _(3)}},A("EditUserStep3")),function(){if(b&&b[P.profileIds.app].roles.includes("manager"))return c.a.createElement("div",{className:F(4),onClick:function(){return _(4)}},"Edit Manager Details")}()),function(e){switch(e){case 1:return c.a.createElement(De,{onComplete:D});case 2:return c.a.createElement(Ue,{onComplete:U,initialProfiles:b});case 3:return c.a.createElement(Le,{onComplete:L,userProfiles:b});case 4:return c.a.createElement(Me,{onComplete:R,userProfiles:b});default:return c.a.createElement(De,{onComplete:D})}}(i),O&&c.a.createElement("div",{className:"message-wrapper success",onClick:function(){T.push("/admin")}},c.a.createElement("div",{className:"message"},A("EditUserMessageSuccess"))),S&&c.a.createElement("div",{className:"message-wrapper failure",onClick:function(){C(!1)}},c.a.createElement("div",{className:"message"},A("EditUserMessageFail"))))},Fe=function(){var e=Object(o.e)(),t=Object(n.useState)(""),a=Object(l.a)(t,2),i=a[0],r=a[1],s=Object(n.useState)(!1),u=Object(l.a)(s,2),m=u[0],d=u[1],v=Object(n.useState)(!1),f=Object(l.a)(v,2),p=f[0],b=f[1],E=N("PUT","admin/group");return m?c.a.createElement(H,{colorTheme:"dark"}):c.a.createElement("div",{className:"editor add-group"},c.a.createElement("div",{className:"step"},c.a.createElement("h3",null,"Add a new group:"),c.a.createElement("div",{className:"admin-form-body"},p&&c.a.createElement("div",{className:"instructions warning"},"Error: ID invalid or already in use. Please try a different ID."),!p&&c.a.createElement("div",{className:"instructions"},"Enter a unique ID for this group and click Submit."),c.a.createElement("div",{className:"admin-input"},c.a.createElement("input",{type:"text",name:"new-group-id",onChange:function(e){return r(e.target.value)},value:i,autoComplete:"off"})),c.a.createElement("button",{type:"button",className:"admin-form-submit-button",onClick:function(){d(!0),E([{key:"groupId",value:i}],{}).then((function(t){e.push("/admin/editGroup?groupId=".concat(i))})).catch((function(e){console.error(e),b(!0),d(!1)}))}},"SUBMIT"))))},_e=function(e){var t=e.initGroupProfile,a=e.onUpdate,i=j(),r=Object(l.a)(i,2),s=(r[0],r[1]),o=b(),m=Object(n.useState)(t),d=Object(l.a)(m,2),v=d[0],f=d[1],p=Object(n.useState)(null),y=Object(l.a)(p,2),h=y[0],O=y[1],g=Object(n.useState)(""),I=Object(l.a)(g,2),k=I[0],S=I[1],C=Object(n.useState)(!1),T=Object(l.a)(C,2),w=(T[0],T[1]),A=N("GET","activity/getActivity"),P=N("GET","admin/activities");Object(n.useEffect)((function(){if(v.activities&&v.activities.length>0){var e=[{key:"activityIds",value:JSON.stringify(v.activities)}];P(e).then((function(e){O(e.data),w(!1)})).catch((function(e){console.error(e)}))}}),[v.activities]);return c.a.createElement("div",{className:"step"},c.a.createElement("div",{className:"admin-form-body"},c.a.createElement("div",{className:"edit-form"},c.a.createElement("div",{className:"edit-form-panel item-list child-list"},c.a.createElement("h4",null,"Manage Journeys"),h?c.a.createElement("div",{className:"item-container"},v.activities.map((function(e){var t=(h[e]||{}).base||{},a=t.title?t.title[s()]:"";return c.a.createElement("div",{key:e,className:"item child-activity"},c.a.createElement("div",{className:"label"},c.a.createElement("div",{className:"activity-title"},a),c.a.createElement("div",{className:"activity-id"},e)),c.a.createElement("button",{type:"button",className:"remove-button",onClick:function(){return function(e){var t=v.activities||[],a=Object(u.a)({},v),n=t.filter((function(t){return t!==e}));a.activities=n,f(a)}(e)}},c.a.createElement("div",{className:"icon"})))}))):null)),c.a.createElement("h4",null,"Enter New Journey Id:"),c.a.createElement("div",{className:"admin-input"},c.a.createElement("input",{type:"text",name:"new-journey-id",onChange:function(e){return S(e.target.value)},value:k,autoComplete:"off"}),c.a.createElement("button",{type:"button",className:"admin-form-add-button",onClick:function(){var e=o.activityPath+k;A([{key:"activityId",value:e},{key:"profileId",value:"base"}]).then((function(t){t.data.base&&"journey"===t.data.base.activityType&&function(e){var t=v.activities||[],a=Object(E.a)(t),n=Object(u.a)({},v);-1===a.indexOf(e)?(a.push(e),n.activities=a,f(n)):alert("Activity already assigned to group.")}(e)})).catch((function(e){console.error(e)}))}},"ADD")),c.a.createElement("button",{type:"button",className:"admin-form-submit-button",onClick:function(){a(v)}},"SUBMIT")))},Be=a(129),Je=function(e){var t=e.initUserList,a=e.groupId,i=e.onUpdate,r=b(),s=Object(n.useRef)(null),o=j(),u=Object(l.a)(o,2),m=u[0],d=(u[1],Object(n.useState)(t)),v=Object(l.a)(d,2),f=v[0],p=(v[1],Object(n.useState)("")),E=Object(l.a)(p,2),y=E[0],h=E[1],O=Object(n.useState)({}),g=Object(l.a)(O,2),I=g[0],k=g[1],S=N("GET","admin/user"),C=N("GET","admin/usersByAccountId"),T=N("POST","admin/user"),w=N("POST","admin/batchGroupUsers");Object(n.useEffect)((function(){var e=[{key:"accountIds",value:JSON.stringify(t||[])}];C(e).then((function(e){k(e.data)})).catch((function(e){console.error(e)}))}),[t]);return c.a.createElement("div",{className:"step"},c.a.createElement("div",{className:"admin-form-body"},c.a.createElement("div",{className:"edit-form"},c.a.createElement("div",{className:"edit-form-panel"},c.a.createElement("h4",null,"Add User"),"User ID:",c.a.createElement("div",{className:"admin-input"},c.a.createElement("input",{type:"text",name:"new-group-id",onChange:function(e){return h(e.target.value)},value:y,autoComplete:"off"})),c.a.createElement("button",{type:"button",className:"admin-form-submit-button",onClick:function(){var e,t=[{key:"username",value:y}];S(t).then((function(n){if(n.data.profiles&&n.data.profiles[r.profileIds.app]){var c=(e=n.data.profiles[r.profileIds.app]).groups||[];if(c.indexOf(a)>-1)return window.alert("User already in group");c.push(a),e.groups=c;var s={profiles:[{type:r.profileIds.app,data:e}]};T(t,s).then((function(){i()})).catch((function(e){console.error(e)}))}})).catch((function(e){console.error(e),window.alert("User not found. Please try again.")}))}},"SUBMIT")),c.a.createElement("div",{className:"edit-form-panel"},c.a.createElement("h4",null,"Batch Add User"),c.a.createElement("span",null,"Upload CSV:"),c.a.createElement("br",null),c.a.createElement("input",{className:"admin-input",type:"file",ref:s,id:"csv-file",name:"csv-file",accept:".csv"}),c.a.createElement("button",{type:"button",className:"admin-form-submit-button",onClick:function(){if(s.current&&s.current.files&&s.current.files.length>0){var e=new FileReader;e.onload=function(e){var t=Be.parse(e.target.result).reduce((function(e,t,a){if(a>0){var n={username:String(t[0]).trim(),group:t[1].trim(),action:t[2].trim().toLowerCase()};e.push(n)}return e}),[]);w([],t).then((function(e){i()})).catch((function(e){window.alert("Error processing batch upload."),console.error(e)}))},e.readAsText(s.current.files[0])}}},"SUBMIT")),c.a.createElement("div",{className:"edit-form-panel item-list child-list"},c.a.createElement("h4",null,"Current Users"),c.a.createElement("div",{className:"item-container"},f.map((function(e){var t=I[e];return t?c.a.createElement("div",{key:e,className:"item"},c.a.createElement("div",{className:"label"},t.name),c.a.createElement("button",{type:"button",className:"remove-button",onClick:function(){return function(e){var t;if(window.confirm(m("AdminConfirmRemoveFromGroup"))){var n=[{key:"accountId",value:e}];S(n).then((function(e){var c=(t=e.data.profiles[r.profileIds.app]).groups||[];c=c.filter((function(e){return e!==a})),t.groups=c;var s={profiles:[{type:r.profileIds.app,data:t}]};T(n,s).then((function(){i()})).catch((function(e){console.error(e)}))})).catch((function(e){console.error(e)}))}}(e)}},c.a.createElement("div",{className:"icon"}))):null})))))))},qe=function(e){var t=e.initUserList,a=e.groupId,i=e.onUpdate,r=b(),s=j(),o=Object(l.a)(s,2),u=o[0],m=(o[1],Object(n.useState)(t)),d=Object(l.a)(m,2),v=d[0],f=(d[1],Object(n.useState)("")),p=Object(l.a)(f,2),E=p[0],y=p[1],h=Object(n.useState)({}),O=Object(l.a)(h,2),g=O[0],I=O[1],k=N("GET","admin/user"),S=N("GET","admin/usersByAccountId"),C=N("POST","admin/user");Object(n.useEffect)((function(){var e=[{key:"accountIds",value:JSON.stringify(t||[])}];S(e).then((function(e){I(e.data)})).catch((function(e){console.error(e)}))}),[t]);return c.a.createElement("div",{className:"step"},c.a.createElement("div",{className:"admin-form-body"},c.a.createElement("div",{className:"edit-form"},c.a.createElement("div",{className:"edit-form-panel"},c.a.createElement("h4",null,"Add Instructor"),"User ID:",c.a.createElement("div",{className:"admin-input"},c.a.createElement("input",{type:"text",name:"new-group-id",onChange:function(e){return y(e.target.value)},value:E,autoComplete:"off"})),c.a.createElement("button",{type:"button",className:"admin-form-submit-button",onClick:function(){var e,t=[{key:"username",value:E}];k(t).then((function(n){if(n.data.profiles&&n.data.profiles[r.profileIds.app]){var c=(e=n.data.profiles[r.profileIds.app]).instructedGroups||[];if(c.indexOf(a)>-1)return window.alert("User already in group");c.push(a),e.instructedGroups=c;var s={profiles:[{type:r.profileIds.app,data:e}]};C(t,s).then((function(){i()})).catch((function(e){console.error(e)}))}})).catch((function(e){console.error(e),window.alert("User not found. Please try again.")}))}},"SUBMIT")),c.a.createElement("div",{className:"edit-form-panel item-list child-list"},c.a.createElement("h4",null,"Current Instructors"),c.a.createElement("div",{className:"item-container"},v.map((function(e){var t=g[e];return t?c.a.createElement("div",{key:e,className:"item"},c.a.createElement("div",{className:"label"},t.name),c.a.createElement("button",{type:"button",className:"remove-button",onClick:function(){return function(e){var t;if(window.confirm(u("AdminConfirmRemoveFromGroup"))){var n=[{key:"accountId",value:e}];k(n).then((function(e){var c=(t=e.data.profiles[r.profileIds.app]).instructedGroups||[];c=c.filter((function(e){return e!==a})),t.instructedGroups=c;var s={profiles:[{type:r.profileIds.app,data:t}]};C(n,s).then((function(){i()})).catch((function(e){console.error(e)}))})).catch((function(e){console.error(e)}))}}(e)}},c.a.createElement("div",{className:"icon"}))):null})))))))},Ve=function(){var e=new URLSearchParams(Object(o.f)().search),t=b(),a=j(),i=Object(l.a)(a,2),r=(i[0],i[1],Object(n.useState)(e.get("groupId"))),s=Object(l.a)(r,2),u=s[0],m=s[1],d=Object(n.useState)(null),v=Object(l.a)(d,2),f=v[0],p=v[1],E=Object(n.useState)("EditGroupDetails"),y=Object(l.a)(E,2),h=y[0],O=y[1],g=Object(n.useState)(u||""),I=Object(l.a)(g,2),k=I[0],S=I[1],C=Object(n.useState)(!1),T=Object(l.a)(C,2),w=T[0],A=T[1],P=Object(n.useState)(!1),x=Object(l.a)(P,2),D=x[0],U=x[1],L=N("GET","activity/getActivity"),R=N("POST","admin/activity"),M=Object(n.useCallback)((function(){if(u){U(!0);var e=[{key:"activityId",value:"".concat(t.activityPath,"app")},{key:"profileId",value:u}];L(e).then((function(e){e.data[u]?(p(e.data[u]),U(!1)):(m(null),U(!1))})).catch((function(e){console.error(e)}))}}),[t.activityPath,L,u]);Object(n.useEffect)((function(){M()}),[u,M]);var G=function(){U(!0),m(k)},F=function(e){p(e),A(!0);var a=[{key:"activityId",value:"".concat(t.activityPath,"app")}];R(a,[{type:u,data:e}]).then((function(){A(!1)})).catch((function(e){A(!1),alert("Failed to update Group. Please try again.")}))},_=function(){M()};return u?w||D||!f?c.a.createElement(H,{colorTheme:"dark"}):c.a.createElement("div",{className:"editor edit-group"},c.a.createElement("div",{className:"tab-list"},c.a.createElement("div",{className:"tab-link",onClick:function(){return O("EditGroupDetails")}},"Edit Details"),c.a.createElement("div",{className:"tab-link",onClick:function(){return O("EditGroupUsers")}},"Edit Users"),c.a.createElement("div",{className:"tab-link",onClick:function(){return O("EditGroupInstructors")}},"Edit Instructors")),u?"EditGroupDetails"===h?c.a.createElement(_e,{initGroupProfile:f,onUpdate:F}):"EditGroupUsers"===h?c.a.createElement(Je,{initUserList:f.users||[],groupId:u,onUpdate:_}):"EditGroupInstructors"===h?c.a.createElement(qe,{initUserList:f.instructors||[],groupId:u,onUpdate:_}):null:null):c.a.createElement("div",{className:"editor edit-group"},c.a.createElement("div",{className:"step"},c.a.createElement("h3",null,"Enter Group Id:"),c.a.createElement("div",{className:"admin-input"},c.a.createElement("input",{type:"text",name:"new-group-id",onChange:function(e){return S(e.target.value)},onKeyDown:function(e){13===e.which&&G()},value:k,autoComplete:"off"})),c.a.createElement("button",{type:"button",className:"admin-form-submit-button",onClick:G},"SUBMIT")))},He=(a(474),function(e){var t=e.milestoneId,a=e.milestoneData,i=e.indexNum,r=e.autoRevealFirst,s=e.locked,o=e.isInstructorView,u=Object(n.useState)("0"),m=Object(l.a)(u,2),d=m[0],v=m[1],f=Object(n.useState)(""),p=Object(l.a)(f,2),E=p[0],y=p[1],h=Object(n.useState)(!1),O=Object(l.a)(h,2),g=O[0],I=O[1],k={height:d},S=A(),C=Object(l.a)(S,1)[0],T=P(),w=j(),x=Object(l.a)(w,2),D=x[0],U=x[1],L=N("POST","instructor/studentActivityStatus"),R=G().userData,M=b();Object(n.useEffect)((function(){0===i&&r&&(v("auto"),y(" open"))}),[r,i]);var F=function(e,t){(t||C.preview)&&T.setActive(e)},_=function(e){if(e.progress)switch(e.progress){case"COMPLETED":return" complete";case"IN_PROGRESS":case"NOT_STARTED":default:return""}return""},B=function(e){var t=C.profiles[e].base.activities,a=[];return t.forEach((function(e){a.push(C.profiles[e].base.activityType)})),a.includes("poll")?" poll":a.includes("assessment")?" assessment":C.profiles[e].base.comments?" comments":""},J=s;return c.a.createElement("div",{className:"milestone"},c.a.createElement("div",{role:"button",tabIndex:0,className:"milestone-card"},c.a.createElement("div",{className:"milestone-title",onClick:function(){return F(t,!0)},role:"button",tabIndex:0},a.base.title[U()]||t),!C.preview&&function(){var e=R.userProfiles[R.profileIds.app].roles;return o||e.includes("admin")||e.includes("customer")||e.includes("contentdev")?c.a.createElement("div",{role:"button",tabIndex:0,className:"milestone-reveal".concat(E),onClick:function(){return I(!g)}},"...",g&&c.a.createElement("div",{className:"contextMenu"},function(){var e=R.userProfiles[R.profileIds.app].roles,t=[];return(e.includes("admin")||e.includes("contentdev"))&&t.push(c.a.createElement("div",{className:"contextOption",role:"button",tabIndex:0,onClick:function(){return window.open("".concat(window.location.origin,"/admin/editActivity?activityId=").concat(M.activityPath).concat(a.base.id))}},D("AdminEditMilestone"))),(e.includes("admin")||e.includes("customer"))&&t.push(c.a.createElement("div",{className:"contextOption",role:"button",tabIndex:0,onClick:function(){return window.open("".concat(window.location.origin,"/admin/activityReports?activityId=").concat(M.activityPath).concat(a.base.id))}},D("AdminGenerateReport"))),c.a.createElement("div",null,t)}(),o&&c.a.createElement("div",{role:"button",tabIndex:0,onClick:function(){return function(){if(o){var e=[{key:"studentId",value:C.studentId},{key:"activityId",value:t},{key:"progress",value:"COMPLETED"}];L(e)}}()},className:"contextOption"},"Mark Complete"))):null}(),c.a.createElement("div",{role:"button",tabIndex:0,className:"milestone-reveal".concat(E),onClick:function(){"0"===d?(v("auto"),y(" open")):(v("0"),y(""))}},c.a.createElement("div",{className:"icon"}))),c.a.createElement("div",{className:"exercise-list",style:k},a.base.activities.map((function(e){var t=C.profiles[e].base,n=C.states[e],i=n[Object.keys(n)[0]].base||{},r=!J;a.base.lockstepped&&"COMPLETED"!==i.progress&&(J=!0),function(e){if(!e.startDate)return!0;var t=new Date,a=new Date(e.startDate);return t.getTime()>a.getTime()}(t)||(r=!1);var s="exercise-card";return r||C.preview||(s+=" locked"),c.a.createElement("div",{role:"button",tabIndex:0,key:e,className:s,onClick:function(){return F(e,r)}},c.a.createElement("div",{className:"exercise-type".concat(B(e))}),c.a.createElement("div",{className:"exercise-title"},t.title[U()]||t.id),c.a.createElement("div",{className:"exercise-indicator".concat(_(i))}))}))))}),Ke=(a(475),function(e){var t=e.targetId,a=G().userData,n=A(),i=Object(l.a)(n,1)[0],r=a.userProfiles[a.profileIds.app].roles,s=[];return(r.includes("admin")||r.includes("contentdev"))&&s.push(c.a.createElement("button",{key:"".concat(t,"_edit"),className:"edit-journey-button","aria-label":"Edit",type:"button",onClick:function(){return window.open("".concat(window.location.origin,"/admin/editActivity?activityId=").concat(t))}})),(r.includes("admin")||r.includes("customer"))&&s.push(c.a.createElement("button",{key:"".concat(t,"_reports"),className:"generate-journey-report-button","aria-label":"Report",type:"button",onClick:function(){return window.open("".concat(window.location.origin,"/admin/activityReports?activityId=").concat(t))}})),i.preview||0===s.length?null:c.a.createElement("div",{className:"admin-buttons-journey-container"},s)}),ze=(a(476),function(e){var t=e.callback,a=e.listData,n=j(),i=Object(l.a)(n,2),r=i[0];i[1];return a?c.a.createElement("div",{id:"test-out",className:"test-out-blocker"},c.a.createElement("div",{className:"test-out-container"},c.a.createElement("div",null,c.a.createElement("p",null,r("TestOutMessageLong"),c.a.createElement("div",{className:"completions-list"},null===a||void 0===a?void 0:a.map((function(e){var t,a="Title";e.base.title&&(a=null===(t=e.base)||void 0===t?void 0:t.title["en-US"]);return c.a.createElement("div",{className:"completions-item",key:""},c.a.createElement("div",{className:"checkmark"}),c.a.createElement("div",null,a))}))))),c.a.createElement("button",{className:"admin-activity-button",type:"button",onClick:t},r("TestOutConfirm")))):c.a.createElement("div",{id:"test-out-individual",className:"test-out-individual-blocker"},c.a.createElement("div",{className:"test-out-individual-container"},c.a.createElement("div",{className:"wrap"},c.a.createElement("div",{className:"circle"},c.a.createElement("div",{className:"animated-checkmark"}))),c.a.createElement("p",null,r("TestOutMessage")),c.a.createElement("button",{className:"admin-activity-button",type:"button",onClick:t},r("TestOutConfirm"))))}),Qe=(a(477),function(e){var t=e.journeyId,a=e.hasForm,i=Object(n.useState)([]),r=Object(l.a)(i,2),s=r[0],u=r[1],m=Object(n.useState)(!0),d=Object(l.a)(m,2),v=d[0],f=d[1],p=A(),b=Object(l.a)(p,1)[0],E=j(),y=Object(l.a)(E,2),h=y[0],O=y[1],g=P(),I=(N("POST","activity/completeChildren"),Object(o.e)()),k=Object(n.useState)([]),S=Object(l.a)(k,2),C=S[0],T=S[1],w=G().userData,x=Object(n.useState)(!1),D=Object(l.a)(x,2),U=D[0],L=D[1];Object(n.useEffect)((function(){void 0!==b.profiles&&u(b.profiles[t].base.activities)}),[b,t]),Object(n.useEffect)((function(){b.profiles&&!b.loading&&(b.preview||M(),f(!1))}),[b]);var R=function(e){if(!b.preview){var t=b.profiles[e].base.activities,a=t.length,n=0;if(t.forEach((function(e){!function(e){var t=b.states[e],a=t[Object.keys(t)[0]];a.base&&"COMPLETED"===a.base.progress&&(n+=1)}(e)})),a===n)return!0}return!1},M=function(){var e=[];b.profiles&&Object.entries(b.profiles).map((function(e){b.profiles[e[0]]})),e.length>0&&L(!0),T(e)};return c.a.createElement("div",{className:"journey-map-container"},c.a.createElement("div",{className:"journey-map"},v&&c.a.createElement(H,{colorTheme:"light"}),!v&&c.a.createElement("div",null,c.a.createElement("div",{className:"journey-header"},c.a.createElement("h2",{onClick:function(){return e=t,void((!0||b.preview)&&g.setActive(e));var e},className:w.userProfiles[w.profileIds.app].roles.includes("admin")?"admin-header":""},b.profiles[t].base.title[O()]||t),c.a.createElement(Ke,{targetId:t}),c.a.createElement("div",{className:"journey-badges"},s.map((function(e){return c.a.createElement("div",{key:e,className:R(e)?"milestone-star complete":"milestone-star"})})))),a&&c.a.createElement("button",{type:"button",className:"journey-submit-button",onClick:function(){return I.push("/submitNew?journeyId=".concat(t))}},h("SubmitButton")),c.a.createElement("div",{className:"journey-content"},s.map((function(e){var a=!1,n=b.profiles[e],i=a,r=b.instructorView;return n.base.lockstepped&&!R(e)&&(a=!0),c.a.createElement(He,{milestoneId:e,autoRevealFirst:!0,key:e,indexNum:b.profiles[t].base.activities.indexOf(e),milestoneData:n,locked:i,isInstructorView:r})}))))),U&&c.a.createElement(ze,{callback:function(){return L(!1)},listData:C}))}),$e=(a(99),a(478),function(e){var t=e.uri,a=e.activityData,i=e.userState,r=e.onProgressChange,s=j(),o=Object(l.a)(s,2)[1],u=Object(n.useState)("NOT_STARTED"),m=Object(l.a)(u,2),d=(m[0],m[1]),v=N("POST","activity/state"),f=A(),p=Object(l.a)(f,1)[0];Object(n.useEffect)((function(){if(i){var e=i.progress||"NOT_STARTED";d(e)}}),[i]);var b,E=function(e){window.open(e),p.preview||v([{key:"activityId",value:t},{key:"updateCompletion",value:"false"}],{activityState:{progress:"COMPLETED"}}).then((function(){r()})).catch((function(e){console.error(e)}))};return a.url?c.a.createElement("div",{className:"resource-item",role:"button",tabIndex:0,onClick:function(){return E(a.url)}},function(e){var t;return t="link",t=e.includes(".pdf")?"pdf":e.includes(".mp3")?"audio":e.includes(".mp4")?"video":e.includes(".png")||e.includes(".jpg")||e.includes(".jpeg")||e.includes(".gif")||e.includes(".svg")?"image":"link",c.a.createElement("div",{className:"resource-icon ".concat(t)})}(a.url),c.a.createElement("div",{className:"resource-text"},function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return e&&e[t]&&e[t][o()]||a}(a,"title")),"image"===function(){switch(a.url.split(".").pop()){case"jpg":case"jpeg":case"png":case"gif":return"image";default:return"link"}}()&&(b=a.url,c.a.createElement("img",{className:"resource-thumbnail",src:b,alt:""}))):(console.warn("No URL for resource: ".concat(a.id)),null)}),We=(a(479),a(97)),Ye=function(e){var t=e.uri,a=e.activityData,i=e.userState,r=e.onProgressChange,s=e.instructor,o=j(),m=Object(l.a)(o,2),d=m[0],v=m[1],f=Object(n.useState)([]),p=Object(l.a)(f,2),b=p[0],y=p[1],h=Object(n.useState)("NOT_STARTED"),O=Object(l.a)(h,2),g=O[0],I=O[1],k=Object(n.useState)(null),S=Object(l.a)(k,2),C=S[0],T=S[1],w=G().userData,P=N("GET","activity/getActivities"),x=N("POST","activity/state"),D=N("POST","activity/submitPoll"),U=A(),L=Object(l.a)(U,1)[0];Object(n.useEffect)((function(){if(i){var e=i.progress||"NOT_STARTED",t=i.optionIds||[];I(e),y(t)}else y([])}),[i]),Object(n.useEffect)((function(){w.userProfiles[w.profileIds.app].groups;var e=[{key:"activityIds",value:JSON.stringify([t])},{key:"profileIds",value:JSON.stringify(["global"])}];P(e).then((function(e){e.data[t].global?T(e.data[t].global):T(a.options.reduce((function(e,t){return e[t.id]=0,e}),{}))})).catch((function(e){console.error(e)}))}),[a,P,t,w.profileIds.app,w.userProfiles]);var R=function(e){var t=0;return C?(a.options.forEach((function(e){t+=C[e.id]})),0===t?0:(C[e]||0)/t*100):0},M=function(e){return We(e,{allowedTags:["p","h1","h2","h3","b","i","em","strong","br","ul","ol","nl","li"]})},F=function(e,t){var a=t?"checkbox":"radio";return c.a.createElement("div",{key:e.id,id:"selection-".concat(e.id),className:"option",onChange:function(){return function(e,t){var a=Object(E.a)(b),n=b.indexOf(e);t?n>-1?a.splice(n,1):a.push(e):a=[e],y(a)}(e.id,t)}},c.a.createElement("label",{htmlFor:e.id},c.a.createElement("input",{type:a,id:e.id,name:"poll",value:e.text[v()]}),c.a.createElement("div",{className:"option-text",dangerouslySetInnerHTML:{__html:M(e.text[v()])}})))};return g&&C?c.a.createElement("section",{className:"poll"},c.a.createElement("div",{className:"section-title"},d("PollLabel")),c.a.createElement("div",{className:"option-text",dangerouslySetInnerHTML:{__html:M(a.question[v()])}}),("NOT_STARTED"===g||"IN_PROGRESS"===g)&&c.a.createElement("div",null,a.options.map((function(e){return F(e,!!a.multiOption)})),!s&&c.a.createElement("button",{type:"button",className:"submit-button",onClick:function(){if(!L.preview){var e=Object(u.a)({},C);b.forEach((function(t){e[t]?e[t]+=1:e[t]=1})),T(e),I("COMPLETED"),D([{key:"activityId",value:t}],{userSelections:b}),x([{key:"activityId",value:t},{key:"updateCompletion",value:"false"}],{activityState:{progress:"COMPLETED",optionIds:b}}).then((function(){r()})).catch((function(e){console.error(e)}))}}},d("SubmitButton"))),"COMPLETED"===g&&a.options.map((function(e){return function(e){return C?c.a.createElement("div",{key:e.id},c.a.createElement("div",{className:"responded-option"},c.a.createElement("div",{className:"option-text",dangerouslySetInnerHTML:{__html:M(e.text[v()])}})),c.a.createElement("div",{className:"poll-response-bar"},c.a.createElement("div",{style:{width:"".concat(R(e.id),"%")},className:"poll-response-fill"},C[e.id]))):null}(e)}))):c.a.createElement(H,null)},Xe=(a(480),a(97)),Ze=function(e){var t=e.uri,a=e.activityData,i=e.userState,r=e.onProgressChange,s=e.instructor,o=j(),m=Object(l.a)(o,2),d=m[0],v=m[1],f=Object(n.useState)(null),p=Object(l.a)(f,2),b=p[0],y=p[1],h=Object(n.useState)("NOT_STARTED"),O=Object(l.a)(h,2),g=O[0],I=O[1],k=Object(n.useState)({}),S=Object(l.a)(k,2),C=S[0],T=S[1],w=N("POST","activity/state"),P=Object(n.useState)(!0),x=Object(l.a)(P,2),D=x[0],U=x[1],L=Object(n.useState)(""),R=Object(l.a)(L,2),M=R[0],G=R[1],F=Object(n.useState)(!1),_=Object(l.a)(F,2),B=_[0],J=_[1],q=A(),V=Object(l.a)(q,1)[0];Object(n.useEffect)((function(){if(b)U(!1);else{var e={};a.questions.forEach((function(t){e[t.id]=[]})),y(e),e&&U(!1)}}),[a.questions,b]),Object(n.useEffect)((function(){if(i){var e=i.progress||"NOT_STARTED";I(e)}}),[i]);var H=function(e){b&&(I(e),function(e,a){return w([{key:"activityId",value:t},{key:"updateCompletion",value:"false"}],{activityState:{progress:e,userAnswers:a}}).then((function(){})).catch((function(e){console.error(e)}))}(e,b).then((function(){r()})).then((function(){J(!0),U(!1),setTimeout((function(){var e;null===(e=document.getElementById("text-feedback"))||void 0===e||e.classList.add("fade")}),9e3),setTimeout((function(){J(!1)}),1e4)})).catch((function(e){console.error(e)})))},K=function(e){return Xe(e,{allowedTags:["p","h1","h2","h3","b","i","em","strong","br","ul","ol","nl","li"]})},z=function(e,t,a){var n=t?"checkbox":"radio",i=!1;return b&&b[a]&&b[a].indexOf(e.id)>-1&&(i=!0),c.a.createElement("div",{id:e.id,key:e.id,className:"answer",onChange:function(n){return function(e,t,a){var n=Object(u.a)({},b),c=Object(E.a)(n[e]),i=c.indexOf(t);a?-1!==i?c.splice(i,1):c.push(t):c=[t],n[e]=c,y(n)}(a,e.id,t)}},c.a.createElement("label",{htmlFor:e.id},c.a.createElement("input",{type:n,id:e.id,name:a,value:e.text[v()],defaultChecked:i}),c.a.createElement("div",{className:"answer-text",dangerouslySetInnerHTML:{__html:K(e.text[v()])}})))},Q=function(e){return c.a.createElement("div",{key:"question-".concat(e.id),id:"question-".concat(e.id),className:"question-container"},function(e){var t=C[e];if("boolean"!==typeof t)return null;var a=t?"feedback correct":"feedback incorrect";return c.a.createElement("div",{id:"feedback-".concat(e),className:a})}(e.id),c.a.createElement("div",{className:"question-text",dangerouslySetInnerHTML:{__html:K(e.text[v()])}}),c.a.createElement("div",{className:"answers-container"},e.answers.map((function(t){return z(t,e.multiAnswer,e.id)}))))};return a?c.a.createElement("section",{className:"assessment"},c.a.createElement("div",{className:"section-title"},a.title[v()]),D&&c.a.createElement("div",{className:"text-feedback"},d("SubmittingAssessment")),!D&&c.a.createElement("div",null,"COMPLETED"!==g&&a.questions.map((function(e,t){return Q(e)})),"COMPLETED"!==g&&!s&&c.a.createElement("button",{type:"button",className:"submit-button",onClick:function(){var e;U(!0),!function(){if(!b)return!1;var e=Object(u.a)({},C),t=!0;return a.questions.forEach((function(a){var n=Object(E.a)(b[a.id]),c=Object(E.a)(a.correct);(n=n.filter((function(e){var t=c.indexOf(e);return!(t>-1)||(c.splice(t,1),!1)}))).length>0||c.length>0?(t=!1,e[a.id]=!1):e[a.id]=!0})),T(e),t}()?(e="IN_PROGRESS",G("incorrect")):(e="COMPLETED",G("correct")),V.preview?(U(!1),J(!0)):H(e)}},d("SubmitButton")),function(){if("COMPLETED"===g)return c.a.createElement("div",{id:"text-feedback-complete",className:"text-feedback pass"},d("AssessmentFeedbackPass"));if(B){if("incorrect"===M)return c.a.createElement("div",{id:"text-feedback",className:"text-feedback fail"},d("AssessmentFeedbackFail"));if("correct"===M)return c.a.createElement("div",{id:"text-feedback",className:"text-feedback pass"},d("AssessmentFeedbackPass"))}return null}())):null},et=Object(n.createContext)({}),tt={thread:null,comments:null,loading:!1,requestUpdate:!1},at=function(e,t){var a=e;switch(t.type){case"REQUEST_UPDATE":a=Object(u.a)({},a,{loading:!0,requestUpdate:!0});break;case"SET_DATA":a=Object(u.a)({},a,{thread:t.data.value.thread,comments:t.data.value.comments,loading:!1,requestUpdate:!1});break;default:a=e}return a},nt=function(e){var t=e.children,a=e.threadId,i=x("GET_THREAD"),r=Object(n.useReducer)(at,tt),s=Object(l.a)(r,2),o=s[0],u=s[1];return Object(n.useEffect)((function(){u({type:"REQUEST_UPDATE"})}),[a]),Object(n.useEffect)((function(){o.requestUpdate&&(console.log("getting thread data"),i({threadId:a}).then((function(e){u({type:"SET_DATA",data:{value:e.data}})})).catch((function(e){console.error(e)})))}),[i,a,o.requestUpdate]),c.a.createElement(et.Provider,{value:[o,u]},t)},ct=function(){return Object(n.useContext)(et)},it=(a(481),function(e){var t=e.onSubmit,a=(e.isInstructor,j()),i=Object(l.a)(a,2),r=i[0],s=(i[1],Object(n.useState)(!1)),o=Object(l.a)(s,2),u=o[0],m=o[1],d=ct(),v=Object(l.a)(d,2),f=v[0],p=v[1],E=b().settings.toggleCommentFieldVisibility,y=function(){m(!u)},h=function(){t(),p({type:"REQUEST_UPDATE"})};if(f.loading||!f.thread)return c.a.createElement(H,{colorTheme:"dark"});return c.a.createElement("div",null,function(){var e,t;return E?c.a.createElement("div",null,c.a.createElement("div",{className:"thread-actions"},c.a.createElement("div",{className:"comment-action reply-action",role:"button",onClick:y},r("CommentLabel"))),u&&f.thread&&c.a.createElement(rt,{commentType:"thread",threadId:null===(t=f.thread)||void 0===t?void 0:t._id,onSubmit:h})):c.a.createElement(rt,{commentType:"thread",threadId:null===(e=f.thread)||void 0===e?void 0:e._id,onSubmit:h})}(),c.a.createElement("div",null,f.thread.comments.map((function(e){return c.a.createElement(st,{key:e,commentId:e,onSubmit:h})}))))}),rt=function(e){var t=e.threadId,a=e.commentType,i=e.onSubmit,r=j(),s=Object(l.a)(r,2),o=s[0],u=(s[1],Object(n.useState)("")),m=Object(l.a)(u,2),d=m[0],v=m[1],f=x("ADD_COMMENT_TO_THREAD"),p=x("ADD_COMMENT_TO_COMMENT"),b=Object(n.useState)(!0),E=Object(l.a)(b,2),y=E[0],h=E[1],O=function(){(new Date).toISOString();if(d.length>=1)switch(h(!1),a){case"thread":f({threadId:t,body:d}).then((function(){h(!0),v(""),i&&i()})).catch((function(e){h(!0),console.error(e.message)}));break;case"comment":p({commentId:t,body:d}).then((function(){h(!0),v(""),i&&i()})).catch((function(e){h(!0),console.error(e.message)}))}};return c.a.createElement("div",null,c.a.createElement("div",{id:"commentId-input",className:"comment-input"},c.a.createElement("input",{onChange:function(e){v(e.target.value)},value:d,placeholder:o("CommentLabel"),onKeyDown:function(e){13===e.which&&O()}}),y&&c.a.createElement("div",{className:"submit-comment",role:"button",onClick:O},o("SubmitButton")),!y&&c.a.createElement("div",{className:"submit-comment"},"Loading")))},st=function(e){var t=e.commentId,a=e.isChild,i=(e.onSubmit,Object(n.useState)(!1)),r=Object(l.a)(i,2),s=r[0],o=r[1],u=j(),m=Object(l.a)(u,1)[0],d=x("FLAG_COMMENT"),v=Object(n.useState)(!1),f=Object(l.a)(v,2),p=f[0],E=f[1],y=ct(),h=Object(l.a)(y,2),O=h[0],g=h[1],N=G().userData,I=b(),k=Object(n.useState)(!1),S=Object(l.a)(k,2),C=S[0],T=S[1];Object(n.useEffect)((function(){(N.userProfiles[I.profileIds.app].roles.includes("superadmin")||N.userProfiles[I.profileIds.app].roles.includes("admin")||N.userProfiles[I.profileIds.app].roles.includes("instructor"))&&E(!0)}),[]),Object(n.useEffect)((function(){I.settings.defaultCollapseComments&&!a&&T(!0)}),[I.settings.defaultCollapseComments,a]);var w=function(){g({type:"REQUEST_UPDATE"})};return O.comments[t].flagged?null:c.a.createElement("div",{className:"comment-container"},c.a.createElement("div",{className:a?"reply-block":"comment-block"},c.a.createElement(J,{userName:O.comments[t].name,autoColor:!0}),c.a.createElement("div",{className:"other"},c.a.createElement("div",{className:"user"},O.comments[t].name||"Unknown"),c.a.createElement("div",{className:"comment"},O.comments[t].body),c.a.createElement("div",{className:"timestamp"},O.comments[t].timeStamp),c.a.createElement("div",{className:"comment-actions"},c.a.createElement("div",{className:"comment-action reply-action",role:"button",onClick:function(){o(!s)}},m("ReplyLabel")),p&&c.a.createElement("div",{className:"comment-action flag-action",role:"button",onClick:function(){confirm(m("commentDeleteMessage"))&&d({commentId:t}).then((function(){alert(m("commentDeleteConfirm")),g({type:"REQUEST_UPDATE"})})).catch((function(e){alert(m("commentDeleteError"))}))}},m("FlagLabel"))),s&&c.a.createElement(rt,{commentType:"comment",threadId:O.comments[t]._id,onSubmit:w}),O.comments[t].replies.map((function(e){return c.a.createElement("div",{className:C?"collapse-comments":"",key:e},c.a.createElement(lt,{commentId:e,onSubmit:w}))})))),function(){var e=C?"Show More +":"Show Less \u2212";return!a&&O.comments[t].replies.length>0?c.a.createElement("div",{className:"show-replies",onClick:function(){T(!C)}},e):null}())},lt=function(e){var t=e.commentId,a=e.onSubmit;return c.a.createElement("div",{className:"child-comment"},c.a.createElement(st,{commentId:t,isChild:!0,onSubmit:a}))},ot=(a(482),function(e){var t=e.groupId,a=e.activityId,i=e.activityState,r=j(),s=Object(l.a)(r,2),o=s[0],u=(s[1],Object(n.useState)("")),m=Object(l.a)(u,2),d=m[0],v=m[1],f=Object(n.useState)(""),p=Object(l.a)(f,2),b=p[0],E=p[1],y=Object(n.useState)(!0),h=Object(l.a)(y,2),O=h[0],g=h[1],I=N("POST","instructor/assignmentFeedback");Object(n.useEffect)((function(){"COMPLETED"===i.userUpload?E("COMPLETED"):E("INCOMPLETE")}),[i.userUpload]);var k=function(){g(!1),I([{key:"groupId",value:t},{key:"exerciseId",value:a},{key:"feedback",value:d},{key:"feedbackStatus",value:b}]).then((function(){g(!0),v("")}))};return c.a.createElement("div",{className:"Feedback"},c.a.createElement("div",{className:"admin-checkbox-item feedback",role:"button",onClick:function(){E("COMPLETED"!==b?"COMPLETED":"INCOMPLETE")},tabIndex:0},c.a.createElement("div",{className:"admin-checkbox".concat("COMPLETED"===b?" checked":"")},c.a.createElement("div",{className:"check"})),c.a.createElement("div",{className:"checkbox-label"},o("MarkAssignmentComplete"))),c.a.createElement("div",{id:"commentId-input",className:"comment-input"},c.a.createElement("input",{onChange:function(e){v(e.target.value)},value:d,placeholder:o("CommentLabel"),onKeyDown:function(e){13===e.which&&k()}}),O&&c.a.createElement("div",{className:"submit-comment",role:"button",onClick:k},o("SubmitButton")),!O&&c.a.createElement("div",{className:"submit-comment"},"Loading")))}),ut=(a(483),function(){var e=j(),t=Object(l.a)(e,1)[0],a=Object(n.useState)(),i=Object(l.a)(a,2),r=i[0],s=i[1],o=Object(n.useState)(!1),u=Object(l.a)(o,2),m=u[0],d=u[1],v=A(),f=Object(l.a)(v,2),p=f[0],b=f[1],y=Object(n.useState)([]),h=Object(l.a)(y,2),O=h[0],g=h[1],I=Object(n.useState)([]),k=Object(l.a)(I,2),S=k[0],C=k[1],T=Object(n.useRef)(null),w=N("POST-FORM","activity/assignment"),P=N("DELETE","activity/assignment"),x=Object(n.useCallback)((function(e){d(!0);var t=new Date,a={attachment:e,activityId:p.active,journeyId:p.journeyId,groupId:p.groupId,fileName:e.name.replace(/[^a-z0-9.& ]/gi,"_"),timestamp:"".concat(t.toLocaleDateString()," ").concat(t.toLocaleTimeString()),studentNotes:""},n=new FormData;n.append("attachment",e),n.append("activityId",a.activityId),n.append("journeyId",a.journeyId),n.append("groupId",a.groupId),n.append("fileName",a.fileName),n.append("studentNotes",a.studentNotes),n.append("timestamp",a.timestamp),w([],n).then((function(e){d(!1),b({type:"FETCH"})})).catch((function(e){console.error(e)}))}),[p.active,p.groupId,p.journeyId,w,b]);return Object(n.useEffect)((function(){r&&r!==T.current&&(x(r),T.current=r)}),[r,x]),Object(n.useEffect)((function(){if(p){p.fetch||p.loading?d(!0):d(!1);var e=(p.states[p.active][p.studentId].base||{submissions:[]}).submissions;g(e||[])}}),[p]),Object(n.useEffect)((function(){var e=O.filter((function(e){return S.indexOf(e.id||"")>=0})).map((function(e){return e.id||""}));e.length!==S.length&&C(e||[]),e.length>0?d(!0):d(!1)}),[O,S]),c.a.createElement("section",{className:"user-upload"},c.a.createElement("div",{className:"section-title"},t("UserUploadLabel")),c.a.createElement(W,{onChange:s,className:"user-upload-section-file-select",accept:".pdf, .txt, .doc, image/*, video/*, audio/*"},c.a.createElement("div",{className:"uploaded-files"},O.map((function(e){var t=e.id,a=e.fileName,n=e.timestamp;return a&&t&&S.indexOf(t)<0?c.a.createElement("div",{key:t,className:"uploaded-file"},c.a.createElement("div",null,a,c.a.createElement("div",{className:"timestamp"},n)),c.a.createElement("button",{className:"remove-file-button",type:"button",onClick:function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e&&(C([].concat(Object(E.a)(S),[e])),P([],{id:e,activityId:p.active,groupId:p.groupId,fileName:t}).then((function(){b({type:"FETCH"})})))}(t,a)}},"\xd7")):null})),m&&c.a.createElement(H,null)),c.a.createElement("div",{className:"upload-file-note"},t("AdminFileSizeLimit"))))}),mt=(a(484),function(e){var t=e.exerciseId,a=A(),i=Object(l.a)(a,1)[0],r=j(),s=Object(l.a)(r,1)[0],o=Object(n.useState)([]),u=Object(l.a)(o,2),m=u[0],d=u[1],v=b(),f=Object(n.useState)(null),p=Object(l.a)(f,2),E=p[0],y=p[1],h=N("GET","instructor/downloadAssignment"),O=(N("POST","instructor/assignmentFeedback"),Object(n.useState)("")),g=Object(l.a)(O,2);g[0],g[1];Object(n.useEffect)((function(){var e;d(null===(e=i.states["http://147.18.97.127/activity/".concat(v.profileIds.app,"/").concat(t)][i.studentId].base)||void 0===e?void 0:e.submissions)}),[i,t]);return c.a.createElement("section",{className:"assignment-download"},c.a.createElement("div",{className:"section-title"},s("AssignmentDownloadTitle")),null===m||void 0===m?void 0:m.map((function(e){return c.a.createElement("div",{key:e.id},c.a.createElement("div",{className:"assignment-item",onClick:function(){return t=e.attachmentPath,void h([{key:"attachmentPath",value:t||""}]).then((function(e){y(e.data)}));var t}},c.a.createElement("div",null,e.fileName,c.a.createElement("div",{className:"timestamp"},e.timestamp)),c.a.createElement("div",{className:"status-icon ".concat(e.status)},e.status),c.a.createElement("div",{className:"assignment-download-icon"})))})),E&&c.a.createElement("div",{style:{display:"none"}},c.a.createElement("iframe",{title:"file-download",src:E})))}),dt=a(97),vt=function(){var e=A(),t=Object(l.a)(e,2),a=t[0],i=t[1],r=G(),s=r.userData,o=r.userDataDispatch,m=Object(n.useState)(null),d=Object(l.a)(m,2),v=d[0],f=d[1],p=Object(n.useState)(null),y=Object(l.a)(p,2),h=y[0],O=y[1],g=Object(n.useState)([]),I=Object(l.a)(g,2),k=I[0],S=I[1],C=Object(n.useState)(!0),T=Object(l.a)(C,2),w=T[0],x=T[1],D=j(),U=Object(l.a)(D,2),L=U[0],R=U[1],M=N("GET","activity/threadId"),F=N("GET","activity/getActivity"),_=N("POST","activity/state"),B=(N("POST","activity/completeChildren"),N("POST","activity/like")),J=N("POST","instructor/studentActivityStatus"),q=P(),V=b(),K=Object(n.useState)(!1),z=Object(l.a)(K,2),Q=z[0],$=z[1],W=Object(n.useState)(!1),Y=Object(l.a)(W,2),X=Y[0],Z=Y[1],ee=Object(n.useState)(!1),te=Object(l.a)(ee,2),ae=te[0],ne=te[1];Object(n.useEffect)((function(){a.active&&a.states&&(f(a.profiles[a.active].base),x(!1))}),[a]),Object(n.useEffect)((function(){if(v&&v.comments){var e=[{key:"activityId",value:a.active},{key:"groupId",value:a.groupId}];M(e).then((function(e){O(e.data)})).catch((function(e){console.error(e)}))}}),[v,M,a.active,a.groupId]),Object(n.useEffect)((function(){if(!a.preview){if(!a.profiles||!a.profiles[a.active]||a.fetch||a.loading)return;if(a.instructorView)return;var e=a.profiles[a.active].base;if(e){var t,n=a.states[a.active][a.studentId].base,c=(t=n&&n.progress||"IN_PROGRESS")||"IN_PROGRESS",r=!0,s=[];"exercise"===e.activityType?s=e.completionReqs||[]:"milestone"!==e.activityType&&"journey"!==e.activityType||(s=e.activities||[]),s.forEach((function(e){var t;if(console.log(e),"commented"===e||"instructorReview"===e)t=function(e,t){return e&&e[t]||"NOT_STARTED"}(n,e);else if("userUpload"===e)t=a.states[a.active].userUpload;else{var c=a.states[e][a.studentId].base;t=c?c.progress:"NOT_STARTED"}"COMPLETED"!==t&&(r=!1)})),r&&(c="COMPLETED"),c!==t&&"exercise"===e.activityType&&function(e){var t=[{key:"activityId",value:a.active},{key:"journeyId",value:a.journeyId},{key:"updateCompletion",value:"true"}];return _(t,{activityState:{progress:e}})}(c).then((function(){i({type:"FETCH"})})).catch((function(e){console.error(e)}))}}}),[a,i,_]),Object(n.useEffect)((function(){if(!w){var e=a.states[a.active];if(e)Object.keys(e)[0]!==s.accountId&&$(!0);if(""!==a.active&&void 0!==a.active){var t=[{key:"activityId",value:a.active},{key:"profileId",value:"likes"}];F(t).then((function(e){var t=(e.data.likes||{}).accountIds||[];S(t)})).catch((function(e){console.error(e)}))}}}),[F,a.active,a.states,w,s.accountId]),Object(n.useEffect)((function(){var e;!a.preview&&(null===v||void 0===v?void 0:v.testOutId)&&"COMPLETED"!==(null===(e=a.states[a.active][a.studentId].base)||void 0===e?void 0:e.progress)&&ne(!0),(null===v||void 0===v?void 0:v.testOutId)&&a.preview&&ne(!0)}),[!1,v,a.active,a.states,a.studentId]);var ce=function(){i({type:"FETCH"})},ie=function(e){var t=function(e){for(var t,a=e,n=new RegExp("<s*a[^>]*>(.*?)<s*/s*a>","g");null!==(t=n.exec(e));){var c=t[0],i=t[1],r=i.split(".");if("mp4"===r[r.length-1]){var s='<video controls>\n\t\t\t\t\t<source src="'.concat(i,'" type="video/mp4">\n\t\t\t\t</video>');a=a.replace(c,s)}}return a}(e);return dt(t,{allowedTags:["p","h1","h2","h3","b","i","em","strong","br","ul","ol","nl","li","img","a","video","source"],allowedAttributes:{a:["href"],video:["controls"],source:["src"],img:["src"]}})},re=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return v&&v[e]&&v[e][R()]||t};return v?c.a.createElement("div",{id:"journey-exercise",className:"journey-exercise"},w&&c.a.createElement(H,{colorTheme:"dark"}),!w&&c.a.createElement("div",{className:"exercise"},c.a.createElement("div",{className:"mobile-close",role:"button",onClick:function(){return q.setActive(""),void f(null)},tabIndex:0},L("BackButton")),c.a.createElement("div",{className:"journey-exercise-title"},re("title")),c.a.createElement(Ke,{targetId:a.active}),Q&&v.instructorReview&&c.a.createElement("button",{className:"submit-button",type:"button",onClick:function(){return function(){if(Q){var e=[{key:"studentId",value:a.studentId},{key:"activityId",value:a.active},{key:"progress",value:"COMPLETED"}];J(e)}}()}},L("MarkAssignmentComplete")),V.settings.canFavorite&&!Q&&c.a.createElement("div",{className:"exercise-favorite",onClick:function(){return function(){var e=s.userProfiles[s.profileIds.favorites].ids||[];(null===e||e&&-1===e.indexOf(a.active))&&o({type:"ADD_FAVORITE",data:{value:a.active}}),e&&-1!==e.indexOf(a.active)&&o({type:"REMOVE_FAVORITE",data:{value:a.active}})}()},role:"button"},c.a.createElement("div",{className:"exercise-favorite-icon".concat(function(){var e=s.userProfiles[s.profileIds.favorites].ids;return e&&-1!==e.indexOf(a.active)?" full":""}())}),L("FavoriteLabel")),V.settings.canLike&&"exercise"===v.activityType&&c.a.createElement("div",{className:"exercise-like",onClick:function(){return function(){var e=k.indexOf(s.accountId),t=Object(E.a)(k);-1===e?t.push(s.accountId):t.splice(e,1),S(t);var n=[{key:"activityId",value:a.active},{key:"profileId",value:"likes"}];B(n).then((function(e){})).catch((function(e){console.error(e)}))}()},role:"button"},c.a.createElement("div",{className:"exercise-like-icon".concat(-1!==k.indexOf(s.accountId)?" full":"")}),k.length>1?"".concat(k.length," ").concat(L("LikeLabelPlural")):"".concat(k.length," ").concat(L("LikeLabel"))),"exercise"===v.activityType&&c.a.createElement("div",{className:"journey-exercise-sections"},c.a.createElement("section",{className:"overview"},c.a.createElement("div",{className:"section-title"},L("OverviewLabel")),c.a.createElement("div",{className:"overview-text",dangerouslySetInnerHTML:{__html:ie(re("desc"))}})),X&&c.a.createElement(ze,{callback:function(){Z(!1)}}),ae&&c.a.createElement("section",null,c.a.createElement("a",{href:null===v||void 0===v?void 0:v.testOutId},L("TestOutLink"))),function(){var e=[];return v?(v.activities.forEach((function(t){var n=a.profiles[t],i=a.states[t][Object.keys(a.states[t])[0]];"resource"===n.base.activityType&&e.push(c.a.createElement($e,{key:n.base.id,uri:t,activityData:n.base,userState:i.base,onProgressChange:ce}))})),e.length>0?c.a.createElement("section",{className:"resources"},c.a.createElement("div",{className:"section-title"},L("ResourcesLabel")),e):null):null}(),v.activities.map((function(e){return function(e){var t=a.profiles[e],n=a.states[e][Object.keys(a.states[e])[0]];if(!t)return null;switch(t.base.activityType){case"assessment":return c.a.createElement(Ze,{key:t.base.id,uri:e,activityData:t.base,userState:n.base,onProgressChange:ce,instructor:Q});case"poll":return c.a.createElement(Ye,{key:t.base.id,uri:e,activityData:t.base,userState:n.base,onProgressChange:ce,instructor:Q});case"resource":return null}return t.base.id}(e)})),!Q&&v.userUpload&&c.a.createElement(ut,null),Q&&v.userUpload&&c.a.createElement(mt,{exerciseId:v.id}),Q&&-1!==v.completionReqs.indexOf("userUpload")&&c.a.createElement("section",{className:"feedback"},c.a.createElement("b",null,L("instructorFeedbackLabel")),c.a.createElement(ot,{activityId:v.id,groupId:a.groupId,activityState:a.states[a.active]})),v.comments&&h&&c.a.createElement("section",{className:"comments"},c.a.createElement("div",{className:"section-title"},L("CommentsLabel")),c.a.createElement(nt,{threadId:h},c.a.createElement(it,{isInstructor:Q,onSubmit:function(){if(!a.preview){var e=[{key:"activityId",value:a.active},{key:"journeyId",value:a.journeyId},{key:"updateCompletion",value:"false"}],t=Object(u.a)({},a.states[a.active][a.studentId].base);t.commented="COMPLETED",_(e,{activityState:t}).then((function(){i({type:"FETCH"})})).catch((function(e){console.error(e)}))}}})))),("journey"===v.activityType||"milestone"===v.activityType)&&c.a.createElement("div",{className:"journey-exercise-sections"},c.a.createElement("section",{className:"overview"},c.a.createElement("div",{className:"section-title"},L("OverviewLabel")),c.a.createElement("div",{className:"overview-text",dangerouslySetInnerHTML:{__html:ie(re("desc"))}}))),c.a.createElement("button",{type:"button",onClick:function(){return function(){var e=document.getElementById("journey-exercise");e&&(e.scrollTop=0)}()},className:"backtop"}," "))):null},ft=function(e){var t=e.journeyId,a=A(),n=Object(l.a)(a,1)[0],i=j(),r=Object(l.a)(i,2),s=(r[0],r[1]);return c.a.createElement("div",{"data-testid":"JourneyList"},void 0!==(null===n||void 0===n?void 0:n.profiles)?null===n||void 0===n?void 0:n.profiles[t].base.title[s()]:"...")},pt=(a(485),function(){var e=G().userData,t=j(),a=Object(l.a)(t,1)[0],n=new URLSearchParams(Object(o.f)().search),i=n.get("journeyId")||"",r=n.get("activityId")||"";return c.a.createElement("div",{className:"Preview"},c.a.createElement("div",{className:"preview-overlay"}),c.a.createElement("div",{className:"preview-banner"},a("PreviewModeTitle"),c.a.createElement("button",{type:"button",onClick:function(){return window.close()},className:"close-preview"},a("ClosePreviewButton"))),c.a.createElement(w,{journeyId:i,studentId:e.accountId,initActive:r,instructorView:!1,preview:!0},c.a.createElement("div",{className:"journey-view"},c.a.createElement(Qe,{journeyId:i}),c.a.createElement(vt,null))))}),bt=(a(134),function(){b();var e=Object(n.useState)(null),t=Object(l.a)(e,2),a=t[0],i=(t[1],Object(n.useState)("")),r=Object(l.a)(i,2),o=r[0],u=(r[1],N("POST-FORM","admin/report/accountsByGroup"));return c.a.createElement("div",{className:"reports-view"},c.a.createElement(s.b,{className:"reports-back",to:"/admin"},"BACK"),c.a.createElement("h2",null,"User Reports"),c.a.createElement("div",{className:"reports-list"},c.a.createElement("div",{className:"report-item"},c.a.createElement("p",{className:"report-title"},"Accounts by Group"),c.a.createElement("p",{className:"report-desc"},"List of accounts by group, useful for cross referencing other reports"),c.a.createElement("button",{type:"button",className:"report-download",onClick:function(){return function(){var e=new FormData;a&&e.append("suppCsv",a),""!==o&&e.append("suppKey",o),u([],e).then((function(e){var t=new Date,a="group-accounts-".concat(t.toISOString(),".csv"),n=new Blob([e],{type:"text/csv"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,a);else{var c=window.URL.createObjectURL(n),i=document.createElement("a");i.href=c,i.setAttribute("download",a),document.body.appendChild(i),i.click()}})).catch((function(e){console.error(e)}))}()}},"Download report"))))}),Et=function(){var e=new URLSearchParams(Object(o.f)().search).get("activityId"),t=b(),a=Object(n.useState)(e),i=Object(l.a)(a,2),r=i[0],u=i[1],m=Object(n.useState)(null),d=Object(l.a)(m,2),v=d[0],f=d[1],p=Object(n.useState)(null),E=Object(l.a)(p,2),y=E[0],h=E[1],O=j(),g=Object(l.a)(O,1)[0],I=Object(n.useState)(null),k=Object(l.a)(I,2),S=k[0],C=k[1],T=Object(n.useState)(""),w=Object(l.a)(T,2),A=w[0],P=w[1],x=N("POST-FORM","admin/report/activityEngagement"),D=function(e){switch(e.target.id){case"activityId":u(t.activityPath+e.target.value);break;case"sinceDate":f(e.target.value);break;case"untilDate":h(e.target.value)}};return c.a.createElement("div",{className:"reports-view"},c.a.createElement(s.b,{className:"reports-back",to:"/admin"},g("BackButton")),c.a.createElement("h2",null,"Activity Reports"),c.a.createElement("div",{className:"reports-list"},c.a.createElement("div",{className:"report-item"},c.a.createElement("p",{className:"report-title"},"Activity Completions"),c.a.createElement("p",{className:"report-desc"},"List of completions by activity, can set sart and end dates for the report."),c.a.createElement("div",{className:"reports-input"},c.a.createElement("div",{className:"reports-label"},"Activity ID"),function(){if(null!==e){var t=e.split("/");return c.a.createElement("input",{id:"activityId",disabled:!0,value:t[t.length-1]})}return c.a.createElement("input",{id:"activityId",onChange:function(e){return D(e)}})}()),c.a.createElement("div",{className:"reports-date-range"},c.a.createElement("div",{className:"reports-input"},c.a.createElement("div",{className:"reports-label"},"Start Date"),c.a.createElement("input",{id:"sinceDate",type:"date",onChange:function(e){return D(e)}})),c.a.createElement("div",{className:"reports-input"},c.a.createElement("div",{className:"reports-label"},"End Date"),c.a.createElement("input",{id:"untilDate",type:"date",onChange:function(e){return D(e)},min:v||""}))),c.a.createElement("div",{className:"supp-file-input"},c.a.createElement("h3",null,"Optional Supplemental CSV"),c.a.createElement("div",{className:"reports-input"},c.a.createElement(W,{onChange:function(e){C(e)},accept:".csv"})),c.a.createElement("div",null,c.a.createElement("div",{className:"label"},"User ID Key:"),c.a.createElement("input",{id:"fileKey",onChange:function(e){return P(e.target.value)}}))),c.a.createElement("button",{type:"button",className:"report-download",onClick:function(){return function(){var e=new FormData,t=v?new Date(v).toISOString():null,a=y?new Date(y).toISOString():null;S&&e.append("suppCsv",S),""!==A&&e.append("suppKey",A);var n=[];n.push({key:"activityId",value:r}),t&&n.push({key:"since",value:t}),a&&n.push({key:"until",value:a}),x(n,e).then((function(e){var t=new Date,a="engagement-".concat(t.toISOString(),".csv"),n=new Blob([e],{type:"text/csv"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,a);else{var c=window.URL.createObjectURL(n),i=document.createElement("a");i.href=c,i.setAttribute("download",a),document.body.appendChild(i),i.click()}})).catch((function(e){console.error(e)}))}()}},"Download report"))))},yt=function(){var e=b(),t=j(),a=Object(l.a)(t,1)[0],i=Object(n.useState)(""),r=Object(l.a)(i,2),o=r[0],u=r[1],m=Object(n.useState)(""),d=Object(l.a)(m,2),v=(d[0],d[1]),f=Object(n.useState)(""),p=Object(l.a)(f,2),E=p[0],y=p[1],h=Object(n.useState)(null),O=Object(l.a)(h,2),g=O[0],I=(O[1],Object(n.useState)(null)),k=Object(l.a)(I,2),S=k[0],C=k[1],T=Object(n.useState)(""),w=Object(l.a)(T,2),A=(w[0],w[1]),P=N("POST-FORM","admin/fileUpload");return c.a.createElement("div",{className:"reports-view"},c.a.createElement(s.b,{className:"reports-back",to:"/admin"},a("BackButton")),c.a.createElement("h2",null,"Group Reports"),c.a.createElement("div",{className:"reports-list"},c.a.createElement("div",{className:"report-item"},c.a.createElement("p",{className:"report-title"},"Group Reports Header"),c.a.createElement("p",{className:"report-desc"},"Description. Separate multiple group IDs with a comma."),c.a.createElement("div",{className:"reports-input"},c.a.createElement("div",{className:"reports-label"},"Group ID"),c.a.createElement("input",{id:"groupId",onChange:function(e){return u(e.target.value)}})),c.a.createElement("div",{className:"reports-input"},c.a.createElement(W,{onChange:function(t){C(t);var a=new FormData;if(S){a.append("file",S);var n=[{key:"groupId",value:o},{key:"fileName",value:t.name}];P(n,a).then((function(t){A("".concat(e.endpoint).concat(t))})).catch((function(e){console.error(e)}))}},accept:".csv"})),c.a.createElement("div",{className:"reports-label"},"Select the key matcher for the file you have uploaded and the report data"),c.a.createElement("div",{className:"report-keys-group"},c.a.createElement("div",{className:"reports-input"},c.a.createElement("div",{className:"reports-label"},"Freeform"),c.a.createElement("input",{id:"fileKey",onChange:function(e){return v(e.target.value)}})),c.a.createElement("div",{className:"reports-input"},c.a.createElement("div",{className:"reports-label"},"Dropdown"),c.a.createElement("select",{onChange:function(e){return y(e.target.value)},value:E},[{id:"Key 1"},{id:"Key 2"},{id:"Key 3"}].map((function(e){return c.a.createElement("option",{key:e.id},e.id)}))))),c.a.createElement("button",{type:"button",className:"report-download",onClick:function(){}},"Download report"))),g&&c.a.createElement("div",{style:{display:"none"}},c.a.createElement("iframe",{title:"report",src:g})))},ht=function(e){var t=e.visible,a=se(),n=Object(l.a)(a,2),i=n[0],r=n[1],s=i.isReady,u=Object(o.e)();return u.listen((function(){"PUSH"===u.action&&r({activityId:""})})),t?s?c.a.createElement("div",{className:"AdminUI"},c.a.createElement(o.a,{exact:!0,path:"/admin"},c.a.createElement(le,null)),c.a.createElement(o.a,{path:"/admin/addActivity"},c.a.createElement(Oe,null)),c.a.createElement(o.a,{path:"/admin/editActivity"},c.a.createElement(Ce,null)),c.a.createElement(o.a,{path:"/admin/importexport"},c.a.createElement(me,null)),c.a.createElement(o.a,{path:"/admin/addUsers"},c.a.createElement(xe,null)),c.a.createElement(o.a,{path:"/admin/editUser"},c.a.createElement(Ge,null)),c.a.createElement(o.a,{path:"/admin/activityReports"},c.a.createElement(Et,null)),c.a.createElement(o.a,{path:"/admin/groupReports"},c.a.createElement(yt,null)),c.a.createElement(o.a,{path:"/admin/userReports"},c.a.createElement(bt,null)),c.a.createElement(o.a,{path:"/admin/addGroup"},c.a.createElement(Fe,null)),c.a.createElement(o.a,{path:"/admin/editGroup"},c.a.createElement(Ve,null)),c.a.createElement(o.a,{path:"/admin/addAnnouncement"},c.a.createElement(Te,null)),c.a.createElement(o.a,{path:"/admin/preview"},c.a.createElement(pt,null))):c.a.createElement("div",null,"Loading..."):null},Ot=function(){return c.a.createElement(re,null,c.a.createElement(ht,{visible:!0}))},gt=(a(486),a(487),function(e){var t,a=e.studentId,i=e.activeStudentJourney,r=G().userData,s=b(),o=j(),u=Object(l.a)(o,1)[0],m=ee(),d=B(),v=Object(l.a)(d,2),f=v[0],p=v[1],E=(null===(t=r.userProfiles[s.profileIds.app].preferences)||void 0===t?void 0:t.defaultJourney)||null;Object(n.useEffect)((function(){i?p({activeJourney:i}):!a&&E&&""===f.activeJourney?p({activeJourney:E}):a||""!==f.activeJourney||1===m.length&&p({activeJourney:m[0].journeyId})}),[f.activeJourney,m,a,E,p,i]);return c.a.createElement("div",{id:"JourneyView","data-testid":"JourneyView"},m.length>1&&""===f.activeJourney?c.a.createElement("div",{"data-testid":"JourneyListWrapper",style:{margin:"20px"}},u("journeySelectMessage"),c.a.createElement("div",{className:"journey-list"},m.map((function(e){return c.a.createElement(w,{key:e.journeyId,journeyId:e.journeyId,groupId:e.groupId,studentId:r.accountId,instructorView:!1},c.a.createElement("div",{className:"journey-list-item",onClick:function(){return p({activeJourney:e.journeyId})},onKeyDown:function(t){13===t.which&&p({activeJourney:e.journeyId})},role:"button",tabIndex:0},c.a.createElement(ft,{journeyId:e.journeyId})))})))):null,""!==f.activeJourney&&c.a.createElement(w,{journeyId:f.activeJourney,studentId:a||r.accountId,instructorView:!!a},c.a.createElement("div",{className:"journey-view"},c.a.createElement(Qe,{journeyId:f.activeJourney}),c.a.createElement(vt,null))))}),jt=function(){var e=G().userData,t=new URLSearchParams(Object(o.f)().search),a=t.get("activityId"),i=t.get("studentId")||e.accountId,r=!!t.get("instructorView"),s=Object(n.useState)(null),u=Object(l.a)(s,2),m=u[0],d=u[1],v=N("GET","activity/activityJourneyId");return console.log("instructorView: ".concat(r)),Object(n.useEffect)((function(){v([{key:"activityId",value:a}]).then((function(e){d(e.data)})).catch((function(e){console.error(e)}))}),[a,v]),m?c.a.createElement(w,{journeyId:m,initActive:a,studentId:i,instructorView:r},c.a.createElement("div",{className:"journey-view"},c.a.createElement(Qe,{journeyId:m}),c.a.createElement(vt,null))):null},Nt=(a(488),function(){var e=b(),t=G().userData,a=j(),i=Object(l.a)(a,1)[0],r=new URLSearchParams(Object(o.f)().search)||null,s=N("GET","user/getThreadId"),u=Object(n.useState)(null),m=Object(l.a)(u,2),d=m[0],v=m[1],f=Object(n.useState)(r.get("threadId")),p=Object(l.a)(f,2),y=p[0],h=p[1],O=Object(n.useState)([]),g=Object(l.a)(O,2),I=g[0],k=g[1],S=N("GET","activity/getActivity"),C=N("POST","user/instructorAlert"),T=Object(n.useState)(!0),w=Object(l.a)(T,2),A=w[0],P=w[1];Object(n.useEffect)((function(){if(!d&&t.userProfiles&&t.userProfiles[e.profileIds.app])if(t.userProfiles[e.profileIds.app].instructorThreadId)v(t.userProfiles[e.profileIds.app].instructorThreadId);else{var a=[{key:"userAccountId",value:t.accountId},{key:"threadKey",value:"instructorThreadId"}];s(a).then((function(e){v(e.data)})).catch((function(e){console.error(e)}))}}),[y,e.profileIds.app,s,t,d]),Object(n.useEffect)((function(){var a=[],n=0,c=t.userProfiles[e.profileIds.app].groups||[],i=t.userProfiles[e.profileIds.app].instructedGroups||[],r=[].concat(Object(E.a)(c),Object(E.a)(i)),s=[];(r=r.filter((function(e){var t=-1===s.indexOf(e);return s.push(e),t}))).forEach((function(c){var i=[{key:"activityId",value:"http://147.18.97.127/activity/".concat(e.profileIds.app,"/app")},{key:"profileId",value:c}];S(i).then((function(e){var t;null===(t=e.data[c].threads)||void 0===t||t.forEach((function(e){a.push(e)}))})).then((function(){k(a)})).then((function(){++n===t.userProfiles[e.profileIds.app].groups.length&&P(!1)})).catch((function(e){console.error(e)}))}))}),[e.profileIds.app,S,t]);var x=function(e){return e===y?"active":""},D=function(){return y?" open":""};return d?A?c.a.createElement(H,null):c.a.createElement("div",{className:"social-view"},c.a.createElement("div",{className:"social-view-title"},c.a.createElement("h1",null,i("chatLabel"))),y&&c.a.createElement("div",{className:"chat-mobile-back",role:"button",onClick:function(){return h(null)},tabIndex:0},i("BackButton")),c.a.createElement("div",{className:"social-view-sections"},c.a.createElement("section",null,c.a.createElement("div",{className:"chat-list".concat(D())},c.a.createElement("button",{id:d,className:x(d),onClick:function(){return h(d)},type:"button"},i("DMWithInstructor")),null===I||void 0===I?void 0:I.map((function(a){return c.a.createElement("button",{key:a.id,id:a.id,className:x(a.id),onClick:function(){return h(a.id)},type:"button"},function(a){var n=t.userProfiles[e.profileIds.base].language;return"string"===typeof a?a:a[n]?a[n]:void 0===a[n]?a[Object.keys(a)[0]]:i("MissingThreadTitle")}(a.content))}))),y&&c.a.createElement("div",{className:"chat-view".concat(D())},c.a.createElement(nt,{threadId:y},c.a.createElement(it,{onSubmit:function(){if(y===d){C([{key:"type",value:"chat"}]).then((function(e){console.log("instructor alert posted")})).catch((function(e){console.error(e)}))}},isInstructor:!!t.userProfiles[e.profileIds.app].roles.includes("instructor")})))))):null}),It=(a(489),function(e){var t=e.groups,a=e.callback,i=j(),r=Object(l.a)(i,2),s=r[0],o=(r[1],Object(n.useState)(null)),u=Object(l.a)(o,2),m=u[0],d=u[1],v=N("GET","instructor/groupsOverview"),f=N("DELETE","instructor/instructorAlert");Object(n.useEffect)((function(){var e=[{key:"groupIds",value:JSON.stringify(t)}];v(e).then((function(e){d(e.data)})).catch((function(e){console.error(e)}))}),[t,v]);var p=function(e){f([{key:"alertId",value:e}])};return m?c.a.createElement("div",{className:"home-view-sections"},c.a.createElement("section",{className:"my-groups"},c.a.createElement("div",{className:"home-section-title"},c.a.createElement("h2",null,s("groupListTitle")),c.a.createElement("div",null,c.a.createElement("ul",{className:"group-list"},c.a.createElement("li",{className:"group-list-headers"},c.a.createElement("div",{className:"group-list-block"},c.a.createElement("div",{className:"group-list-name"},s("groupLabel")),c.a.createElement("div",{className:"group-list-percentage"},s("progressLabel")))),t.map((function(e,t){return c.a.createElement("li",{key:e,onClick:function(){return a(e)},className:"group"},c.a.createElement("div",{className:"group-list-block"},c.a.createElement("div",{className:"group-list-name"},e),c.a.createElement("div",{className:"group-list-percentage"},"".concat(function(e){var t=m.groupAppProfiles[e].activities||[],a=m.groupAppProfiles[e].users||[],n=0;return 0===t.length||0===a.length?0:(t.forEach((function(t){var c=(m.groupJourneyProfiles[e][t]||{}).progress||{},i=0,r=0;(m.journeyMaps[t].profiles[t].base.activities||[]).forEach((function(e){var a=m.journeyMaps[t].profiles[e].base.activities||[];r+=a.length})),a.forEach((function(e){var t=c[e]||0;0!==r&&(i+=t/r)})),n+=i/a.length*100})),Math.round(n/t.length))}(e),"%"))))})))))),c.a.createElement("section",{className:"my-notifications"},c.a.createElement("div",{className:"home-section-title"},c.a.createElement("h2",null,s("instructorActionsLabel")),t.map((function(e){return c.a.createElement("div",{key:e,className:"group-actions-block"},c.a.createElement("div",{className:"group-actions-title"},e),function(e){var t;return m.groupAppProfiles[e].instructorAlerts?c.a.createElement(X,{noteData:null===(t=m.groupAppProfiles[e])||void 0===t?void 0:t.instructorAlerts,clickCallback:p}):c.a.createElement("div",{key:e,className:"no-notes"},s("NoActionsMessage"))}(e),function(e){var t=[];return m.groupAppProfiles[e].pendingAssignmentIds&&m.groupAppProfiles[e].pendingAssignmentIds.map((function(a){var n=m.groupAppProfiles[e].pendingAssignments[a];t.push(c.a.createElement(Z,{key:a,noteData:n}))})),t}(e))}))))):null}),kt=(a(490),function(e){var t=e.studentName,a=e.studentId,i=e.callback,r=e.groupData,s=e.groupId,o=j(),u=Object(l.a)(o,2),m=u[0],d=(u[1],b()),v=Object(n.useState)(null),f=Object(l.a)(v,2),p=f[0],E=f[1],y=Object(n.useState)(null),h=Object(l.a)(y,2),O=h[0],g=h[1],I=N("GET","instructor/userProfiles"),k=N("GET","user/getThreadId"),S=N("POST","instructor/userAlert");Object(n.useEffect)((function(){I([{key:"accountId",value:a}]).then((function(e){E(e.data.userProfiles)})).catch((function(e){console.error(e)}))}),[a]),Object(n.useEffect)((function(){p&&p[d.profileIds.app]&&(p[d.profileIds.app].instructorThreadId?g(p[d.profileIds.app].instructorThreadId):k([{key:"userAccountId",value:a},{key:"threadKey",value:"instructorThreadId"}]).then((function(e){g(e.data)})).catch((function(e){console.error(e)})))}),[a,p]);if(!p||!O)return c.a.createElement(H,{colorTheme:"dark"});var C=(r.groupProfile.activities||[]).map((function(e){return s?c.a.createElement(w,{key:e,journeyId:e,groupId:s,studentId:a,instructorView:!1},c.a.createElement("div",{key:e,onClick:function(){return i(e)},role:"button"},c.a.createElement(te,{journeyId:e,includeCohort:!0}))):null}));return c.a.createElement("div",{className:"student-view"},c.a.createElement("div",{className:"student-view-title"},c.a.createElement("h1",null,"".concat(t).concat(m("studentsProfile")))),c.a.createElement("div",{className:"student-view-sections"},c.a.createElement("section",{className:"my-journeys"},c.a.createElement("div",{className:"student-section-title"},c.a.createElement("h2",null,m("studentActiveJourneys")),c.a.createElement("div",{className:"options"})),c.a.createElement("div",{className:"current-journeys"},C)),c.a.createElement("section",{className:"my-social"},c.a.createElement("div",{className:"student-section-title"},c.a.createElement("h2",null,m("studentsChat")+t),c.a.createElement("div",{className:"options"})),c.a.createElement(nt,{threadId:O},c.a.createElement(it,{onSubmit:function(){var e=[{key:"userAccountId",value:a}],t={content:m("UserNotificationMessage"),url:"/chat"};S(e,t)},isInstructor:!0})))))}),St=(a(491),function(e){var t=e.breadcrumbs,a=e.onBreadcrumbClick,n=e.studentName,i=e.studentJourneyTitle,r=e.groupName,s=j(),o=Object(l.a)(s,1)[0];return c.a.createElement("div",{className:"banner"},c.a.createElement("div",{tabIndex:0,role:"button",onClick:function(){return a("instructor")},className:"banner-item breadcrumb"},c.a.createElement("span",{className:"label"},o("InstructorViewTitle"))),t.map((function(e){return c.a.createElement("div",{role:"button",tabIndex:0,id:e,key:e,className:"banner-item breadcrumb",onClick:function(){return a(e)}},c.a.createElement("span",{className:"label"},function(e){return"student"===e?n:"group"===e?r:"journey"===e?i:(console.warn("Breadcrumbs reference missing"),"Page")}(e)))})))}),Ct=function(e){var t,a=e.groupId,i=e.callback,r=j(),s=Object(l.a)(r,1)[0],o=Object(n.useState)(null),u=Object(l.a)(o,2),m=u[0],d=u[1],v=Object(n.useState)([]),f=Object(l.a)(v,2),p=f[0],E=f[1],y=N("GET","instructor/groupData"),h=N("POST","instructor/groupThread"),O=Object(n.useState)("userName"),g=Object(l.a)(O,2),I=g[0],k=g[1],S=N("POST","instructor/groupAnnouncement"),C=N("DELETE","instructor/groupAnnouncement"),T=Object(n.useState)(""),w=Object(l.a)(T,2),A=w[0],P=w[1],x=Object(n.useState)(!1),D=Object(l.a)(x,2),U=D[0],L=D[1],R=b(),M=Object(n.useState)(!0),F=Object(l.a)(M,2),_=F[0],B=F[1],q=G().userData,V=Object(n.useState)("tab1"),K=Object(l.a)(V,2),z=K[0],Q=K[1],$=Object(n.useState)(""),W=Object(l.a)($,2),Y=W[0],X=W[1];Object(n.useEffect)((function(){y([{key:"groupId",value:a}]).then((function(e){d(e.data),B(!1)})).catch((function(e){console.error(e)}))}),[a]),Object(n.useEffect)((function(){var e=function(e){var t=m.groupProfile.activities||[],n=0;return 0===t.length?0:(t.forEach((function(t){var c=m.activityProfiles[t],i=c.profiles[t].base.activities||[],r=(((m.groupJourneyProfiles[t]||{})[a]||{}).progress||{})[e]||0,s=0;i.forEach((function(e){var t=c.profiles[e].base.activities||[];s+=t.length})),0!==s&&(n+=r/s*100)})),n/=t.length)};m&&function(){var t=m.groupProfile.users||[],a=[];t.forEach((function(t){var n=(m.userProfiles[t]||{}).base||{};a.push({userId:t,userName:n.name||"",progress:e(t)})})),E(a)}()}),[m]);var Z=function(e){return e===I?" active":""},ee=function(e){var t;window.confirm(s("AnnouncementRemoveConfirm"))&&(t=e,L(!0),C([{key:"groupId",value:a},{key:"announcementId",value:t}]).then((function(){L(!1)})).catch((function(e){L(!1),console.warn(e)})))},te=function(e){var t=q.userProfiles[R.profileIds.base].language;return"string"===typeof e?e:e[t]?e[t]:void 0===e[t]?e[Object.keys(e)[0]]:s("AnnouncementMessageMissing")},ae=function(e){Q(e)},ne=function(e){return z===e?"active":"hidden"},ce=function(){};return m?c.a.createElement("div",{className:"home-view-sections"},c.a.createElement("section",{className:"group-students"},c.a.createElement("div",{className:"home-section-title"},c.a.createElement("h2",null,a),c.a.createElement("div",null,c.a.createElement("ul",{className:"student-list"},c.a.createElement("li",{className:"student-list-headers"},c.a.createElement("div",{className:"student-list-block"},c.a.createElement("div",{className:"student-list-name".concat(Z("userName")),onClick:function(){return k("userName")},role:"button"},s("InstructorGroupSortName")),c.a.createElement("div",{className:"student-list-percentage".concat(Z("progress")),onClick:function(){return k("progress")},role:"button"},s("InstructorGroupSortProgress")))),function(){switch(I){case"progress":return p.sort((function(e,t){return e.progress>t.progress?1:-1}));case"userName":default:return p.sort((function(e,t){return e.userName.replace(/^([^\s]+)\s(.+)$/,"$2, $1")>t.userName.replace(/^([^\s]+)\s(.+)$/,"$2, $1")?1:-1}))}}().map((function(e,t){return c.a.createElement("li",{key:"student-".concat(e.userId),id:"student-".concat(t),onClick:function(){return i(e.userId,e.userName,m)}},c.a.createElement("div",{className:"student-block"},c.a.createElement(J,{userName:e.userName,autoColor:!0}),c.a.createElement("div",{className:"student-list-name"},e.userName),c.a.createElement("div",{className:"student-list-percentage"},"".concat(Math.round(e.progress),"%"))))})))))),c.a.createElement("section",{className:"group-actions"},c.a.createElement("div",{className:"group-actions-tabs"},c.a.createElement("button",{className:ne("tab1"),onClick:function(){return ae("tab1")},type:"button"},s("AnnouncementTabTitle")),c.a.createElement("button",{className:ne("tab2"),onClick:function(){return ae("tab2")},type:"button"},s("CommentsTabTitle"))),c.a.createElement("section",{id:"announcements",className:ne("tab1")},c.a.createElement("div",{className:"instructor-annoucement-container home-section-title admin-input"},c.a.createElement("h3",null,s("AnnouncementGroupTitle")),c.a.createElement("p",null,s("AnnouncementContentHeader")),c.a.createElement("input",{onChange:function(e){return function(e){P(e)}(e.target.value)},value:A}),c.a.createElement("div",{className:"announcement-button-container"},c.a.createElement("button",{type:"button",className:"admin-form-submit-button",onClick:function(){return function(){L(!0);var e=q.userProfiles[R.profileIds.base].language,t={id:(new Date).valueOf(),date:(new Date).toISOString(),content:{}};t.content[e]=A,S([{key:"groupId",value:a}],t).then((function(){P(""),L(!1)})).catch((function(e){L(!1),console.warn(e)}))}()}},s("SubmitButton")))),_&&c.a.createElement(H,{colorTheme:"dark"}),!_&&c.a.createElement("div",{className:""},c.a.createElement("h3",null,s("CurrentAnnouncements")),null===(t=m.groupProfile.alerts)||void 0===t?void 0:t.map((function(e){return c.a.createElement("div",{className:"announcement",key:e.id},c.a.createElement("div",null,c.a.createElement("div",{className:"message"},te(e.content)),c.a.createElement("div",{className:"timestamp"},e.date)),c.a.createElement("div",{onClick:function(){return ee(e.id)},className:"remove-announcement",role:"button",tabIndex:0},"\xd7"))})))),c.a.createElement("section",{id:"threads",className:ne("tab2")},c.a.createElement("div",{className:"group-thread admin-input"},c.a.createElement("h3",null,s("InstructorGroupThreadTitle")),c.a.createElement("p",null,s("InstructorGroupThreadHeader")),c.a.createElement("input",{onChange:function(e){return X(e.target.value)},value:Y}),c.a.createElement("div",{className:"thread-button-container"},c.a.createElement("button",{type:"button",className:"admin-form-submit-button",onClick:function(){return function(){L(!0);m.groupProfile;var e=q.userProfiles[R.profileIds.base].language,t=[{key:"groupId",value:a}],n={date:(new Date).toISOString(),content:{}};n.content[e]=Y,h(t,n).then((function(e){e.data})).catch((function(e){L(!1),console.warn(e)}))}()}},s("SubmitButton")))),(null===m||void 0===m?void 0:m.groupProfile.threads)&&c.a.createElement("div",null,null===m||void 0===m?void 0:m.groupProfile.threads.map((function(e){return c.a.createElement("div",null,c.a.createElement("div",{className:"thread-title"},te(e.content)),c.a.createElement(nt,{threadId:e.id},c.a.createElement(it,{onSubmit:ce,isInstructor:!0})))}))))),U&&c.a.createElement("div",{className:"editor"},c.a.createElement("div",{className:" message-wrapper submitting"},c.a.createElement("div",{className:"message"},s("ActivityMessageSubmiting"))))):c.a.createElement(H,{colorTheme:"dark"})},Tt=(a(492),function(e){var t=e.user,a=j(),i=Object(l.a)(a,2),r=(i[0],i[1],Object(o.e)()),s=b(),u=new URLSearchParams(Object(o.f)().search).get("studentAccountId"),m=Object(n.useState)(),d=Object(l.a)(m,2),v=d[0],f=d[1],p=Object(n.useState)(),E=Object(l.a)(p,2),y=E[0],h=E[1],O=Object(n.useState)(null),g=Object(l.a)(O,2),I=g[0],k=g[1],S=Object(n.useState)(),C=Object(l.a)(S,2),T=C[0],w=C[1],A=Object(n.useState)(),P=Object(l.a)(A,2),x=P[0],D=P[1],U=Object(n.useState)(""),L=Object(l.a)(U,2),R=L[0],M=(L[1],Object(n.useState)([])),G=Object(l.a)(M,2),F=G[0],_=G[1],B=Object(n.useState)("instructor"),J=Object(l.a)(B,2),q=J[0],V=J[1],H=N("GET","activity/getActivities"),K=N("GET","instructor/groupData");Object(n.useEffect)((function(){if(console.log("queryStudentId: ".concat(u)),u){var e,a=[{key:"activityIds",value:JSON.stringify(["".concat(s.activityPath,"app")])},{key:"profileIds",value:JSON.stringify(t.userProfiles[s.profileIds.app].instructedGroups||[])}];u&&H(a).then((function(n){return e=function(e,t){var a=null;return t.forEach((function(t){((e["".concat(s.activityPath,"app")][t]||{}).users||[]).indexOf(u||"")>-1&&(a=t)})),a}(n.data,t.userProfiles[s.profileIds.app].instructedGroups||[]),K(a=[{key:"groupId",value:e||""}])})).then((function(t){e&&(_(["group","student"]),f(u),h(t.data.userProfiles[u||""].base.name),k(e),D(t.data),V("student"))})).catch((function(e){console.error(e)}))}}),[s.activityPath,s.profileIds.app,H,K,u,t.userProfiles]);var z=function(e,t,a){f(e),h(t),V("student"),_(["group","student"]),D(a)},Q=function(e){k(e),V("group"),_(["group"])},$=function(e){w(e),V("journey")};return c.a.createElement("div",{className:"home-view instructor"},c.a.createElement(St,{breadcrumbs:F,onBreadcrumbClick:function(e){r.push("/instructor"),V(e),"student"===e?_(["group","student"]):"group"===e?_(["group"]):"journey"===e||_([])},studentName:y||void 0,studentJourneyTitle:R,groupName:I}),function(e){switch(e){case"student":return y&&v&&x&&I?c.a.createElement(kt,{studentName:y,studentId:v,callback:$,groupData:x,groupId:I}):null;case"group":return c.a.createElement(Ct,{groupId:I,callback:z});case"journey":return T&&v?c.a.createElement(gt,{activeStudentJourney:T,studentId:v}):null;case"instructor":default:return c.a.createElement(It,{groups:t.userProfiles[s.profileIds.app].instructedGroups,callback:Q})}}(q))}),wt=(a(493),function(){var e=Object(n.useState)(null),t=Object(l.a)(e,2),a=t[0],i=t[1],r=Object(n.useState)(""),s=Object(l.a)(r,2),o=s[0],u=s[1],m=j(),d=Object(l.a)(m,2),v=d[0],f=(d[1],N("POST-FORM","manager/studentsProgressReports"));return c.a.createElement("div",{className:"manager-view"},c.a.createElement("div",{className:"manager-view-sections"},c.a.createElement("section",null,c.a.createElement("h2",null,"Reports:"),c.a.createElement("div",{className:"manager-reports"},c.a.createElement("div",{className:"manager-report"},c.a.createElement("h3",null,"Student Progress Report"),c.a.createElement("div",{className:"supp-file-input"},c.a.createElement("h3",null,"Optional Supplemental CSV"),c.a.createElement("div",{className:"reports-input"},c.a.createElement(W,{onChange:function(e){i(e)},accept:".csv"})),c.a.createElement("div",null,c.a.createElement("div",{className:"label"},"User ID Key:"),c.a.createElement("input",{id:"fileKey",onChange:function(e){return u(e.target.value)}}))),c.a.createElement("button",{type:"button",className:"submit-button",onClick:function(){var e=new FormData;a&&e.append("suppCsv",a),""!==o&&e.append("suppKey",o),f([],e).then((function(e){var t=new Date,a="progress-".concat(t.toISOString(),".csv"),n=new Blob([e],{type:"text/csv"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,a);else{var c=window.URL.createObjectURL(n),i=document.createElement("a");i.href=c,i.setAttribute("download",a),document.body.appendChild(i),i.click()}})).catch((function(e){console.error(e)}))}},v("SubmitButton")))))))}),At=(a(494),a(495),function(){var e=b(),t=j(),a=Object(l.a)(t,1)[0],i=G().userData,r=B(),s=Object(l.a)(r,2),u=(s[0],s[1],Object(n.useState)(!0)),m=Object(l.a)(u,2),d=m[0],v=m[1],f=Object(n.useState)(["journey","chat"]),p=Object(l.a)(f,2),E=p[0],y=p[1];Object(n.useEffect)((function(){var t=function(e){var t=E;-1===t.indexOf(e)&&(t.push(e),y(t))};i.userProfiles&&((i.userProfiles[e.profileIds.app].roles.includes("admin")||i.userProfiles[e.profileIds.app].roles.includes("customer")||i.userProfiles[e.profileIds.app].roles.includes("contentdev"))&&t("admin"),i.userProfiles[e.profileIds.app].roles.includes("instructor")&&t("instructor"),i.userProfiles[e.profileIds.app].roles.includes("manager")&&t("manager"),v(!1))}),[e.profileIds.app,i,E]);return d||!e?c.a.createElement("div",{className:"App"},c.a.createElement(K,{scale:"0.5",colorTheme:"dark"})):c.a.createElement("div",{className:"App"},c.a.createElement("div",{className:"version"},"v".concat("2.2.0")),i!=={}&&c.a.createElement(V,{appName:a("AppNameLabel"),userName:i.userProfiles[e.profileIds.base].name||"Username",avatar:!0,logout:!0}),c.a.createElement("div",{className:"content"},i.userProfiles&&c.a.createElement(q,{views:E,roles:i.userProfiles[e.profileIds.app].roles,userName:i.userProfiles[e.profileIds.base].name||"Username"}),c.a.createElement("div",{id:"main-content",className:"main-content"},c.a.createElement(o.a,{exact:!0,path:"/"},c.a.createElement(ne,null)),c.a.createElement(o.a,{path:"/journey"},c.a.createElement(gt,null)),c.a.createElement(o.a,{path:"/chat"},c.a.createElement(Nt,null)),c.a.createElement(o.a,{path:"/instructor"},c.a.createElement(Tt,{user:i})),c.a.createElement(o.a,{path:"/admin"},c.a.createElement(Ot,null)),c.a.createElement(o.a,{path:"/manager"},c.a.createElement(wt,null)),c.a.createElement(o.a,{path:"/activityInJourney"},c.a.createElement(jt,null)))))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));console.info("".concat("Journey App Demo Site"," ").concat("2.2.0")),r.a.render(c.a.createElement(s.a,null,c.a.createElement((function(e){var t=e.children,a=Object(n.useState)(F),i=Object(l.a)(a,2),r=i[0],s=i[1];Object(n.useEffect)((function(){s((function(e){return Object(u.a)({},e,{isReady:!0})}))}),[]);var o=Object(n.useCallback)((function(e){s((function(t){return Object(u.a)({},t,{},e)}))}),[]);return c.a.createElement(_.Provider,{value:[r,o]},t)}),null,c.a.createElement((function(e){var t=e.children,a=Object(n.useState)(v),i=Object(l.a)(a,2),r=i[0],s=i[1];return Object(n.useEffect)((function(){d.a.get("".concat("http://50.229.61.229:2120/","clientConfig"),f).then((function(e){var t=Object(u.a)({},v,{},e.data,{endpoint:"http://50.229.61.229:2120/",isReady:!0});s(t)})).catch((function(e){console.error(e)}))}),["http://50.229.61.229:2120/"]),c.a.createElement(p.Provider,{value:r},t)}),null,c.a.createElement((function(){return b().isReady?c.a.createElement(g,null,c.a.createElement(M,null,c.a.createElement(At,null))):null}),null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},99:function(e,t,a){}},[[222,1,2]]]);